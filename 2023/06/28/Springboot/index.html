

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="星光浮梦">
  <meta name="keywords" content="">
  
    <meta name="description" content="xml-ssm文件配置 在maven中配置springmvc 12345&lt;dependency&gt;            &lt;groupId&gt;org.springframework&lt;&#x2F;groupId&gt;            &lt;artifactId&gt;spring-webmvc&lt;&#x2F;artifactId&gt;            &lt;versio">
<meta property="og:type" content="article">
<meta property="og:title" content="Springboot">
<meta property="og:url" content="http://example.com/2023/06/28/Springboot/index.html">
<meta property="og:site_name" content="Isolde">
<meta property="og:description" content="xml-ssm文件配置 在maven中配置springmvc 12345&lt;dependency&gt;            &lt;groupId&gt;org.springframework&lt;&#x2F;groupId&gt;            &lt;artifactId&gt;spring-webmvc&lt;&#x2F;artifactId&gt;            &lt;versio">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011010193.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011023094.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011036811.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011049656.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011057609.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011109114.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011121350.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011135290.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011147820.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718015701207.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011207438.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011215418.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011222626.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011232289.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011242885.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011249938.png">
<meta property="og:image" content="c:\Users\g1o2a\AppData\Roaming\Typora\typora-user-images\image-20230424230929874.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011305410.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718020129405.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011319504.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011328452.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011335128.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011347239.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011355193.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011427893.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011443733.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011455571.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011509108.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718011527463.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718025553616.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718025607362.png">
<meta property="og:image" content="http://example.com/2023/06/28/Springboot/image-20230718182633136.png">
<meta property="article:published_time" content="2023-06-28T07:02:15.000Z">
<meta property="article:modified_time" content="2023-07-18T10:26:46.073Z">
<meta property="article:author" content="星光浮梦">
<meta property="article:tag" content="框架">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2023/06/28/Springboot/image-20230718011010193.png">
  
  
  
  <title>Springboot - Isolde</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":50,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>星光浮梦</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Springboot"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-06-28 15:02" pubdate>
          2023年6月28日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          78k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          646 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Springboot</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="xml-ssm文件配置"><a href="#xml-ssm文件配置" class="headerlink" title="xml-ssm文件配置"></a>xml-ssm文件配置</h1><ol>
<li><p>在maven中配置springmvc</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>在项目处右键，选择Open Module Setting，创建resourcs和webapp等标准的文件。</p>
<p><img src="/2023/06/28/Springboot/image-20230718011010193.png" srcset="/img/loading.gif" lazyload alt="image-20230718011010193"></p>
</li>
<li><p>创建controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello world&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>在resources处创建Spring config文件</p>
<p><img src="/2023/06/28/Springboot/image-20230718011023094.png" srcset="/img/loading.gif" lazyload alt="image-20230718011023094"></p>
<p>创建applicationContext.xml和spring-serlvet.xml文件</p>
<p>applicationContext.xml文件配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.xgfm&quot;</span> <span class="hljs-attr">use-default-filters</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:exclude-filter</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;annotation&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">context:component-scan</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>spring-servlet.xml文件配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.xgfm&quot;</span> <span class="hljs-attr">use-default-filters</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:include-filter</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;annotation&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">context:component-scan</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-driven</span>/&gt;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>web.xml配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context-param</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">context-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">listener</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="hljs-tag">&lt;/<span class="hljs-name">listener-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">listener</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:spring-servlet.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>HelloService</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloService</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello ssm&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
</li>
<li><p>HelloController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    HelloService helloService;<br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span>&#123;<br>        String hello=helloService.hello();<br>        System.out.println(<span class="hljs-string">&quot;hello=&quot;</span>+hello);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello world&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
</li>
<li><p>然后运行tomcat就可运行了</p>
</li>
</ol>
<h1 id="java-ssm文件配置"><a href="#java-ssm文件配置" class="headerlink" title="java-ssm文件配置"></a>java-ssm文件配置</h1><ol>
<li><p>在maven中配置springmvc</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>编写HelloController</p>
</li>
<li><p>编写java写的config组件</p>
</li>
<li><p><img src="/2023/06/28/Springboot/image-20230718011036811.png" srcset="/img/loading.gif" lazyload alt="image-20230718011036811"></p>
</li>
</ol>
<p>config文件如图</p>
<p><mark>踩坑记录1</mark></p>
<p>在pom.xml中没写以下代码，导致无法配置tomcat</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>war<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><mark>踩坑记录2</mark></p>
<p>webInit</p>
<p>报错：目前未解决</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">ServletRegistration.<span class="hljs-type">Dynamic</span> <span class="hljs-variable">springMVC</span> <span class="hljs-operator">=</span> servletContext.addServlet(<span class="hljs-string">&quot;springMVC&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">DispatcherServlet</span>(ctx));<br></code></pre></td></tr></table></figure>

<h1 id="springboot创建"><a href="#springboot创建" class="headerlink" title="springboot创建"></a>springboot创建</h1><ol>
<li>创建新模块，选择Spring Initializr，并且配置模块相关的基本信息</li>
</ol>
<p><img src="/2023/06/28/Springboot/image-20230718011049656.png" srcset="/img/loading.gif" lazyload alt="image-20230718011049656"></p>
<p><img src="/2023/06/28/Springboot/image-20230718011057609.png" srcset="/img/loading.gif" lazyload alt="image-20230718011057609"></p>
<ul>
<li>4是取包名</li>
<li>5选择与之相对应的jdk版本</li>
<li>6.7日常下一步</li>
<li>然后选择Spring web，并且版本号选择2.x.x开头的，高版本的JDK8不适配</li>
</ul>
<p>另附其他俩种方法：</p>
<ol>
<li><p>在线创建：<a target="_blank" rel="noopener" href="https://start.spring.io/">https://start.spring.io</a></p>
</li>
<li><p>Maven改造</p>
</li>
<li><p>也可以使用国内阿里云提供的start站</p>
<p><a target="_blank" rel="noopener" href="http://start.aliyun.com/">http://start.aliyun.com</a></p>
</li>
</ol>
<h1 id="Springboot部分注解"><a href="#Springboot部分注解" class="headerlink" title="Springboot部分注解"></a>Springboot部分注解</h1><p>@SpringBootConfiguration</p>
<p>@EnableAutoConfiguration</p>
<p>@ComponentScan</p>
<h3 id="EnableAutoConfiguration"><a href="#EnableAutoConfiguration" class="headerlink" title="@EnableAutoConfiguration"></a>@EnableAutoConfiguration</h3><p>@Import注解</p>
<p>在原生的spring Framework中，组件装配逐步升级</p>
<ol>
<li>spring2.5+ @Component</li>
<li>spring3.0+ @Configuration+@Bean</li>
<li>spring3.1+ @EnableXXX+@Import</li>
</ol>
<p>@ComponentScan注解</p>
<p>对启动项进行包扫描</p>
<h1 id="Maven标签–parent"><a href="#Maven标签–parent" class="headerlink" title="Maven标签–parent"></a>Maven标签–parent</h1><ol>
<li>定义java的编译版本</li>
<li>定义项目编码格式</li>
<li>定义依赖的版本号</li>
<li>项目打包配置</li>
<li>自动化的资源过滤</li>
<li>自动化的插件配置</li>
</ol>
<h1 id="Web容器配置"><a href="#Web容器配置" class="headerlink" title="Web容器配置"></a>Web容器配置</h1><p>springboot支持三个服务</p>
<p>目前使用servlet技术栈</p>
<p>可以使用的服务器分别是tomcat，jetty和undertow</p>
<h3 id="选择web容器配置"><a href="#选择web容器配置" class="headerlink" title="选择web容器配置"></a>选择web容器配置</h3><p>在application.prooerties中配置</p>
<p><img src="/2023/06/28/Springboot/image-20230718011109114.png" srcset="/img/loading.gif" lazyload alt="image-20230718011109114"></p>
<p>第一行为web容器选择</p>
<p>server.port代表端口的选择</p>
<p>最后一行为是否压缩容器</p>
<h1 id="tomcat容器配置"><a href="#tomcat容器配置" class="headerlink" title="tomcat容器配置"></a>tomcat容器配置</h1><p>开启访问日志，默认的日志位置在项目运行的临时目录中</p>
<p>日志设置语句如下</p>
<p><img src="/2023/06/28/Springboot/image-20230718011121350.png" srcset="/img/loading.gif" lazyload alt="image-20230718011121350"></p>
<h1 id="HTTPS证书配置"><a href="#HTTPS证书配置" class="headerlink" title="HTTPS证书配置"></a>HTTPS证书配置</h1><ol>
<li>生成https证书</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">keytool -genkey -<span class="hljs-built_in">alias</span> myhttps -keyalg RSA -keysize 2048 -keystore xgfm_key.p12 -validity 365<br></code></pre></td></tr></table></figure>

<p>2.在application.properties中配置证书</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">server.ssl.key-alias</span>=<span class="hljs-string">myhttps</span><br><span class="hljs-attr">server.ssl.key-store</span>=<span class="hljs-string">classpath:xgfm_key.p12</span><br><span class="hljs-attr">server.ssl.key-store-password</span>=<span class="hljs-string">111111</span><br></code></pre></td></tr></table></figure>

<p>3.创建config文件</p>
<p>配置tomcat文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.demo02.config;<br><br><span class="hljs-keyword">import</span> org.apache.catalina.Context;<br><span class="hljs-keyword">import</span> org.apache.catalina.connector.Connector;<br><span class="hljs-keyword">import</span> org.apache.tomcat.util.descriptor.web.SecurityCollection;<br><span class="hljs-keyword">import</span> org.apache.tomcat.util.descriptor.web.SecurityConstraint;<br><span class="hljs-keyword">import</span> org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TomcatConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    TomcatServletWebServerFactory <span class="hljs-title function_">tomcatServletWebServerFactory</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">TomcatServletWebServerFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TomcatServletWebServerFactory</span>()&#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postProcessContext</span><span class="hljs-params">(Context context)</span> &#123;<br>                SecurityConstraint securityConstraint=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityConstraint</span>();<br>                securityConstraint.setUserConstraint(<span class="hljs-string">&quot;CONFIDENTIAL&quot;</span>);<br>                <span class="hljs-type">SecurityCollection</span> <span class="hljs-variable">collection</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityCollection</span>();<br>                collection.addPattern(<span class="hljs-string">&quot;/*&quot;</span>);<br>                securityConstraint.addCollection(collection);<br>                context.addConstraint(securityConstraint);<br>            &#125;<br>        &#125;;<br>        factory.addAdditionalTomcatConnectors(myConnectors());<br>        <span class="hljs-keyword">return</span> factory;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> Connector <span class="hljs-title function_">myConnectors</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Connector</span> <span class="hljs-variable">connector</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Connector</span>(<span class="hljs-string">&quot;org.apache.coyote.http11.Http11NioProtocol&quot;</span>);<br>        connector.setScheme(<span class="hljs-string">&quot;http&quot;</span>);<br>        connector.setPort(<span class="hljs-number">8081</span>);<br>        connector.setSecure(<span class="hljs-literal">false</span>);<br>        connector.setRedirectPort(<span class="hljs-number">8080</span>);<br>        <span class="hljs-keyword">return</span> connector;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h1 id="配置文件名称和路径"><a href="#配置文件名称和路径" class="headerlink" title="配置文件名称和路径"></a>配置文件名称和路径</h1><p>配置文件有4个位置</p>
<p>-config&#x2F;application.properties</p>
<p>-application.properties</p>
<p> -src&#x2F;main&#x2F;resources&#x2F;config&#x2F;application.properties</p>
<p>-src&#x2F;main&#x2F;resources&#x2F;application.properties</p>
<p>(偷一张我帅气班长的图)</p>
<p><img src="/2023/06/28/Springboot/image-20230718011135290.png" srcset="/img/loading.gif" lazyload alt="image-20230718011135290"></p>
<p>四个的优先级是依次降低的</p>
<p>同时可以进行自定义配置文件路径</p>
<p><img src="/2023/06/28/Springboot/image-20230718011147820.png" srcset="/img/loading.gif" lazyload alt="image-20230718011147820"></p>
<p>注意<mark>配置文件的路径要以&#x2F;结尾</mark></p>
<p>如果自定义配置文件的路径，打包完运行jar包的时候，要用spring.config.loaction进行指定</p>
<p>例如：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">java</span> <span class="hljs-string">-jar xxx.jar --spring.config.location=calsspath:/xgfm/</span><br></code></pre></td></tr></table></figure>

<p>但这些一般情况下是没有必要的</p>
<p>文件名称也是可以进行更换的</p>
<p>比如创建xgfm.properites</p>
<p>然后在project setting同样进行配置</p>
<p><img src="/2023/06/28/Springboot/image-20230718015701207.png" srcset="/img/loading.gif" lazyload alt="image-20230718015701207"></p>
<p>文件中有一个properites就可以了</p>
<p>如果自定义文件的名称也要在运行jar包的时候，用spring.config.name进行指定</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">java -jar xxx.jar --spring.config.name=xgfm<br></code></pre></td></tr></table></figure>

<h1 id="普通属性注入"><a href="#普通属性注入" class="headerlink" title="普通属性注入"></a>普通属性注入</h1><p><mark>为了避免中文乱码，要在设置中的editor-file Encodings中的文件编码为UTF-8</mark></p>
<p>可以在application.properties中输入属性，在model处使用，数组属性需要使用英文逗号进行分隔</p>
<p><img src="/2023/06/28/Springboot/image-20230718011207438.png" srcset="/img/loading.gif" lazyload alt="image-20230718011207438"></p>
<p>使用value注解，其中数组也是可以注入的</p>
<p><img src="/2023/06/28/Springboot/image-20230718011215418.png" srcset="/img/loading.gif" lazyload alt="image-20230718011215418"></p>
<p>这是spring的普通属性注入，与springboot无太大关系</p>
<p>并且在有的时候会将这些注入写在其他的properties中，避免application.properties过于臃肿，然后会写在一个xxx.properties之中，这时候就需要手动加载该properties</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PropertySource(&quot;classpath:xxx.properties&quot;)</span><br></code></pre></td></tr></table></figure>

<h1 id="类型安全的属性注入"><a href="#类型安全的属性注入" class="headerlink" title="类型安全的属性注入"></a>类型安全的属性注入</h1><p>使用以下语句进行类型安全的属性注入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;xxx&quot;)</span><br></code></pre></td></tr></table></figure>

<p> xxx为文件的名称前缀，然后就会自动注入</p>
<p>使用类型安全的属性注入的代码案例如下</p>
<p><img src="/2023/06/28/Springboot/image-20230718011222626.png" srcset="/img/loading.gif" lazyload alt="image-20230718011222626"></p>
<h1 id="properties引用Maven中的配置"><a href="#properties引用Maven中的配置" class="headerlink" title="properties引用Maven中的配置"></a>properties引用Maven中的配置</h1><p>在properties中引用Maven中的配置，应该使用@...@，而不是${….}，不然会和本地起冲突</p>
<h1 id="使用短命令行参数"><a href="#使用短命令行参数" class="headerlink" title="使用短命令行参数"></a>使用短命令行参数</h1><p>在终端启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">java -jar properties-0.0.1-SNAPSHOT.jar --server.port=8081<br></code></pre></td></tr></table></figure>

<p>如果省略server将不会生效，如果想要能够生效，需要在application.properties中配置以下信息</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">server.port</span>=<span class="hljs-string">$&#123;port&#125;</span><br></code></pre></td></tr></table></figure>

<p>这个情况下，以下代码能够有效</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">java -jar properties-0.0.1-SNAPSHOT.jar --port=8081<br></code></pre></td></tr></table></figure>

<p>但是如果配置了properties，但没有输入，则会报错，那么我们就需要这么写properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">server.port</span>=<span class="hljs-string">$&#123;port:8080&#125;</span><br></code></pre></td></tr></table></figure>

<p>这种情况下，如果没有port输入，则自动使用8080作为端口启动</p>
<h1 id="YAML配置"><a href="#YAML配置" class="headerlink" title="YAML配置"></a>YAML配置</h1><p>将application的文件后缀更改为yaml或者yml</p>
<p>yaml配置是有顺序的，而properties是无序的，这是两者的差距，并且yaml支持自动配置除application以外的文件名称，改文件名是完全没有必要的</p>
<p>yaml配置是比较自动化的，编写属性会有跳出的提示</p>
<p><img src="/2023/06/28/Springboot/image-20230718011232289.png" srcset="/img/loading.gif" lazyload alt="image-20230718011232289"></p>
<p>并且强制要求：后要有空格，否则将会报错，这个空格一定不能少</p>
<p>案例：</p>
<p>同样的book的属性注入</p>
<p><img src="/2023/06/28/Springboot/image-20230718011242885.png" srcset="/img/loading.gif" lazyload alt="image-20230718011242885"></p>
<p>要这也进行编写，注意小说后都有一个空格</p>
<p>案例中分别有单个属性，普通数组，对象数组的注入</p>
<p>注意格式的要求</p>
<h1 id="内省机制"><a href="#内省机制" class="headerlink" title="内省机制"></a>内省机制</h1><p>属性注入是根据get和set方法进行判断该使用哪个get方法进行注入。这是利用了java中的反射机制（这里也只是提一嘴），并且该机制与yaml和properties无关，是自带的</p>
<h1 id="Profile"><a href="#Profile" class="headerlink" title="Profile"></a>Profile</h1><p>不同情况下要使用的环境是不同的，重复更改环境会很麻烦，springboot准备了生产环境切换</p>
<p><img src="/2023/06/28/Springboot/image-20230718011249938.png" srcset="/img/loading.gif" lazyload alt="image-20230718011249938"></p>
<p>然后再application.properties中配置生产环境</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.profiles.active</span>=<span class="hljs-string">dev</span><br><span class="hljs-attr">spring.profiles.active</span>=<span class="hljs-string">prod</span><br><span class="hljs-attr">spring.profiles.active</span>=<span class="hljs-string">test</span><br></code></pre></td></tr></table></figure>

<h1 id="JAVA日志配置"><a href="#JAVA日志配置" class="headerlink" title="JAVA日志配置"></a>JAVA日志配置</h1><p>日志框架分为日志门面和日志实现</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/kkp2PTC3rbmHlXHnF95FLw">日志配置文章</a></p>
<p>这里需要了解清楚日志体系</p>
<h1 id="SpringBoot日志配置"><a href="#SpringBoot日志配置" class="headerlink" title="SpringBoot日志配置"></a>SpringBoot日志配置</h1><p>springboot的默认日志门面是Logback</p>
<p>还是这个哦</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/kkp2PTC3rbmHlXHnF95FLw">日志配置文章</a></p>
<h1 id="SpingBoot-Thymeleaf"><a href="#SpingBoot-Thymeleaf" class="headerlink" title="SpingBoot+Thymeleaf"></a>SpingBoot+Thymeleaf</h1><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Uvv1q3iQn2IwAB1crHWS1g"> Spring Boot+Thymeleaf</a></p>
<p>传统Java模板引擎不同的是，Thymeleaf支持HTML原型</p>
<h1 id="Thymeleaf实践"><a href="#Thymeleaf实践" class="headerlink" title="Thymeleaf实践"></a>Thymeleaf实践</h1><p>创建项目时候需要导入模板</p>
<p>选择以下俩项</p>
<p><img src="C:\Users\g1o2a\AppData\Roaming\Typora\typora-user-images\image-20230424230929874.png" srcset="/img/loading.gif" lazyload alt="image-20230424230929874"></p>
<p>然后在application.properties中导入以下设置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># THYMELEAF (ThymeleafAutoConfiguration)</span><br><span class="hljs-comment"># 开启模板缓存（默认值： true ）</span><br><span class="hljs-attr">spring.thymeleaf.cache</span>=<span class="hljs-string">true</span><br><span class="hljs-comment"># 检查模板是否存在，然后再呈现</span><br><span class="hljs-attr">spring.thymeleaf.check-template</span>=<span class="hljs-string">true</span><br><span class="hljs-comment"># 检查模板位置是否正确（默认值 :true ）</span><br><span class="hljs-attr">spring.thymeleaf.check-template-location</span>=<span class="hljs-string">true</span><br><span class="hljs-comment">#Content-Type 的值（默认值： text/html ）</span><br><span class="hljs-attr">spring.thymeleaf.content-type</span>=<span class="hljs-string">text/html</span><br><span class="hljs-comment"># 开启 MVC Thymeleaf 视图解析（默认值： true ）</span><br><span class="hljs-attr">spring.thymeleaf.enabled</span>=<span class="hljs-string">true</span><br><span class="hljs-comment"># 模板编码</span><br><span class="hljs-attr">spring.thymeleaf.encoding</span>=<span class="hljs-string">UTF-8</span><br><span class="hljs-comment"># 要被排除在解析之外的视图名称列表，⽤逗号分隔</span><br><span class="hljs-attr">spring.thymeleaf.excluded-view-names</span>=<span class="hljs-string"></span><br><span class="hljs-comment"># 要运⽤于模板之上的模板模式。另⻅ StandardTemplate-ModeHandlers( 默认值： HTML5)</span><br><span class="hljs-attr">spring.thymeleaf.mode</span>=<span class="hljs-string">HTML5</span><br><span class="hljs-comment"># 在构建 URL 时添加到视图名称前的前缀（默认值： classpath:/templates/ ）</span><br><span class="hljs-attr">spring.thymeleaf.prefix</span>=<span class="hljs-string">classpath:/templates/</span><br><span class="hljs-comment"># 在构建 URL 时添加到视图名称后的后缀（默认值： .html ）</span><br><span class="hljs-attr">spring.thymeleaf.suffix</span>=<span class="hljs-string">.html</span><br><br></code></pre></td></tr></table></figure>

<p>编写User类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.thymeleaf;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String address;<br><br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Integer id)</span> &#123;<br>        <span class="hljs-built_in">this</span>.id = id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> username;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUsername</span><span class="hljs-params">(String username)</span> &#123;<br>        <span class="hljs-built_in">this</span>.username = username;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getAddress</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> address;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAddress</span><span class="hljs-params">(String address)</span> &#123;<br>        <span class="hljs-built_in">this</span>.address = address;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>编写UserController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.thymeleaf;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.ui.Model;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">index</span><span class="hljs-params">(Model model)</span>&#123;<br>        List&lt;User&gt; users=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10</span>;i++)&#123;<br>            User u=<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>            u.setId(i);<br>            u.setUsername(<span class="hljs-string">&quot;xgfm&quot;</span>+i);<br>            u.setAddress(<span class="hljs-string">&quot;www.xgfm.com&quot;</span>+i);<br>            users.add(u);<br>        &#125;<br>        model.addAttribute(<span class="hljs-string">&quot;users&quot;</span>,users);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>创建hello.html(此处的html有遍历，可以借鉴一下)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">th:each</span>=<span class="hljs-string">&quot;u : $&#123;users&#125;&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;u.id&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;u.username&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;u.address&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="Thymeleaf手动渲染"><a href="#Thymeleaf手动渲染" class="headerlink" title="Thymeleaf手动渲染"></a>Thymeleaf手动渲染</h1><p>自动渲染时直接返回到前端页面的</p>
<p>为了方便编写测试类进行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThymeleafApplicationTests</span> &#123;<br>	<span class="hljs-meta">@Autowired</span><br>	TemplateEngine templateEngine;<br>	<span class="hljs-meta">@Test</span><br>	<span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoads</span><span class="hljs-params">()</span> &#123;<br>		<span class="hljs-type">Context</span> <span class="hljs-variable">ctx</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Context</span>();<br>		ctx.setVariable(<span class="hljs-string">&quot;username&quot;</span>,<span class="hljs-string">&quot;佛耶戈&quot;</span>);<br>		ctx.setVariable(<span class="hljs-string">&quot;position&quot;</span>,<span class="hljs-string">&quot;太痛了&quot;</span>);<br>		ctx.setVariable(<span class="hljs-string">&quot;salary&quot;</span>,<span class="hljs-string">&quot;600000&quot;</span>);<br>		<span class="hljs-type">String</span> <span class="hljs-variable">mail</span> <span class="hljs-operator">=</span> templateEngine.process(<span class="hljs-string">&quot;mail&quot;</span>, ctx);<br>		System.out.println(mail);<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>控制台输出结果</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hello,欢迎！<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>佛耶戈<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>加入破败军团，您的入职信息如下<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>职位<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>太痛了<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>薪水<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>600000<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>这样就可以手动渲染结果了</p>
<p><mark>目前还有一些莫名其妙的报错，尚未解决，另外还不知道怎么把手动渲染结果直接输出到前端页面</mark></p>
<p>先放一下</p>
<h1 id="Thymeleaf简单表达式"><a href="#Thymeleaf简单表达式" class="headerlink" title="Thymeleaf简单表达式"></a>Thymeleaf简单表达式</h1><p>表达式语法包含如下</p>
<h3 id=""><a href="#" class="headerlink" title="${}"></a>${}</h3><p> 最普通和常见的引用类型</p>
<p>可以直接进行引用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:object</span>=<span class="hljs-string">&quot;$&#123;user&#125;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;*&#123;username&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;*&#123;address&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;*&#123;id&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>*{}和${}用起来的效果是相近的</p>
<h3 id="-1"><a href="#-1" class="headerlink" title="*{}"></a>*{}</h3><p>与上面的${}效果类似，所以用起来是没有很大差距的</p>
<h3 id="-2"><a href="#-2" class="headerlink" title="#{}"></a>#{}</h3><p>主要用于国际化</p>
<p>messages.properties</p>
<p>message_zh_CN.properties</p>
<p><img src="/2023/06/28/Springboot/image-20230718011305410.png" srcset="/img/loading.gif" lazyload alt="image-20230718011305410"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;#&#123;hello&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>根据浏览器的语言环境进行选择</p>
<p>中文环境选择message_zh_CN.properties，英文环境选择messages.properties</p>
<h3 id="-3"><a href="#-3" class="headerlink" title="@{}"></a>@{}</h3><p>引用URL地址</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html">//绝对地址<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;https://localhost:8080/hello.js&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>//相对地址<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;~/hello.js&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>//协议地址<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;//localhost:8080/hello.js&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>//带参数的URL<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;//localhost:8080/hello.js(name=&#x27;zhengru&#x27;,age=99)&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>//自动加载上下文相关的地址<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;/hello.js&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="Thymeleaf各种表达式"><a href="#Thymeleaf各种表达式" class="headerlink" title="Thymeleaf各种表达式"></a>Thymeleaf各种表达式</h1><h3 id="字面量"><a href="#字面量" class="headerlink" title="字面量"></a>字面量</h3><ul>
<li>文本字面量</li>
<li>数字字面量</li>
<li>布尔字面量</li>
<li>Null字面量</li>
<li>字面量标记</li>
</ul>
<h3 id="文本运算"><a href="#文本运算" class="headerlink" title="文本运算"></a>文本运算</h3><p>如果字符串中包含EL表达式输出的变量，也可以使用另一种简答的方式，叫做字面量置换</p>
<p>即使用||替换”…”+”…”</p>
<p>例子</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;&#x27;hello&#x27;+$&#123;user.username&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">|hello$&#123;user.username&#125;|</span>&quot;&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>这俩都能一起使用</p>
<h3 id="布尔运算"><a href="#布尔运算" class="headerlink" title="布尔运算"></a>布尔运算</h3><ul>
<li>二元运算符：and, or</li>
<li>布尔非（一元运算符）：!, not</li>
</ul>
<h3 id="比较和相等"><a href="#比较和相等" class="headerlink" title="比较和相等"></a>比较和相等</h3><p>表达式里的值可以使用 <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code> 和 <code>&lt;=</code> 符号比较。<code>==</code> 和 <code>!=</code> 运算符用于检查相等（或者不相等）。注意 <code>XML</code>规定 <code>&lt;</code> 和 <code>&gt;</code> 标签不能用于属性值，所以应当把它们转义为 <code>&lt;</code> 和 <code>&gt;</code></p>
<p>如果不想转义，也可以使用别名：gt (&gt;)；lt (&lt;)；ge (&gt;&#x3D;)；le (&lt;&#x3D;)；not (!)。还有 eq (&#x3D;&#x3D;), neq&#x2F;ne (!&#x3D;)</p>
<h3 id="条件运算符"><a href="#条件运算符" class="headerlink" title="条件运算符"></a>条件运算符</h3><p>类似于我们 Java 中的三目运算符</p>
<h1 id="内置对象"><a href="#内置对象" class="headerlink" title="内置对象"></a>内置对象</h1><h3 id="基本内置对象："><a href="#基本内置对象：" class="headerlink" title="基本内置对象："></a>基本内置对象：</h3><ul>
<li>#ctx：上下文对象。</li>
<li>#vars: 上下文变量。</li>
<li>#locale：上下文区域设置。</li>
<li>#request：（仅在 Web 上下文中）HttpServletRequest 对象。</li>
<li>#response：（仅在 Web 上下文中）HttpServletResponse 对象。</li>
<li>#session：（仅在 Web 上下文中）HttpSession 对象。</li>
<li>#servletContext：（仅在 Web 上下文中）ServletContext 对象。</li>
</ul>
<h3 id="实用内置对象："><a href="#实用内置对象：" class="headerlink" title="实用内置对象："></a>实用内置对象：</h3><ul>
<li>#execInfo：有关正在处理的模板的信息。</li>
<li>#messages：在变量表达式中获取外部化消息的方法，与使用＃{…}语法获得的方式相同。</li>
<li>#uris：转义URL &#x2F; URI部分的方法</li>
<li>#conversions：执行配置的转换服务（如果有）的方法。</li>
<li>#dates：java.util.Date对象的方法：格式化，组件提取等</li>
<li>#calendars：类似于#dates但是java.util.Calendar对象。</li>
<li>#numbers：用于格式化数字对象的方法。</li>
<li>#strings：String对象的方法：contains，startsWith，prepending &#x2F; appending等</li>
<li>#objects：一般对象的方法。</li>
<li>#bools：布尔评估的方法。</li>
<li>#arrays：数组方法。</li>
<li>#lists：列表的方法。</li>
<li>#sets：集合的方法。</li>
<li>#maps：地图方法。</li>
<li>#aggregates：在数组或集合上创建聚合的方法。</li>
<li>#ids：处理可能重复的id属性的方法（例如，作为迭代的结果）。</li>
</ul>
<p>相对应的方法可以在属性值中查看</p>
<h1 id="设置属性值"><a href="#设置属性值" class="headerlink" title="设置属性值"></a>设置属性值</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">th:attr</span>=<span class="hljs-string">&quot;src=@&#123;/1.png&#125;,title=$&#123;user.username&#125;,alt=$&#123;user.username&#125;&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/myapp/1.png&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;javaboy&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;javaboy&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;/1.png&#125;&quot;</span> <span class="hljs-attr">th:alt</span>=<span class="hljs-string">&quot;$&#123;user.username&#125;&quot;</span> <span class="hljs-attr">th:title</span>=<span class="hljs-string">&quot;$&#123;user.username&#125;&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;/1.png&#125;&quot;</span> <span class="hljs-attr">th:alt-title</span>=<span class="hljs-string">&quot;$&#123;user.username&#125;&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h1><p>遍历的状态支持</p>
<ul>
<li>index 当前索引从0开始</li>
<li>count 当前索引从1开始</li>
<li>size   被遍历的元素数量</li>
<li>current 每次遍历的遍历变量</li>
<li>odd   当前的遍历是偶数还是奇数</li>
<li>first 当前是否为第一次遍历</li>
<li>last 当前是否为最后遍历</li>
</ul>
<h1 id="Thymeleaf分支语句"><a href="#Thymeleaf分支语句" class="headerlink" title="Thymeleaf分支语句"></a>Thymeleaf分支语句</h1><p>th:if语句,该判断语句不仅只接受布尔值，其他类型的值同样也接受</p>
<p>true|false输出如下</p>
<p><img src="/2023/06/28/Springboot/image-20230718020129405.png" srcset="/img/loading.gif" lazyload alt="image-20230718020129405"></p>
<p>th:unless语句</p>
<p>就是th:if语句的取反</p>
<p>th:switch,case语句</p>
<p>情况判断语句，例如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html">//在外面包裹一层遍历语句<br><span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:switch</span>=<span class="hljs-string">&quot;$&#123;state.add&#125;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">th:case</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span>odd<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">th:case</span>=<span class="hljs-string">&quot;*&quot;</span>&gt;</span>even<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="本地变量"><a href="#本地变量" class="headerlink" title="本地变量"></a>本地变量</h1><p>可以使用th:with定义一个本地变量，前面已经提到并且使用过了，这里就不再过多赘述了</p>
<h1 id="内联"><a href="#内联" class="headerlink" title="内联"></a>内联</h1><p>可以使用属性将数据放入页面模板之中，但是很多时候内联的方式看起来更加直观和简洁一些，并且拼接也会显得更加自然一些，例子</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello [[$&#123;user.username&#125;]]<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>[[...]]</code> 对应于 th:text （结果会是转义的 HTML）</p>
<p><code>[(...)]</code>对应于 th:text，它不会执行任何的 HTML 转义</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:with</span>=<span class="hljs-string">&quot;str=&#x27;hello &lt;strong&gt;javaboy&lt;/strong&gt;&#x27;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>[[$&#123;str&#125;]]<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>[($&#123;str&#125;)]<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>显示结果分别是</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>第一行为hello &lt;strong&gt;javaboy&lt;/strong&gt;<br><span class="hljs-regexp">//</span>第二行为hello javaboy(javaboy为加粗后的)<br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Uvv1q3iQn2IwAB1crHWS1g"> Spring Boot+Thymeleaf</a></p>
<p>总的来说，可以多看几遍该文章</p>
<p> 在script中使用，要这样使用</p>
<p><img src="/2023/06/28/Springboot/image-20230718011319504.png" srcset="/img/loading.gif" lazyload alt="image-20230718011319504"></p>
<h1 id="SpingBoot-Freemarker"><a href="#SpingBoot-Freemarker" class="headerlink" title="SpingBoot+Freemarker"></a>SpingBoot+Freemarker</h1><p>经典之开篇给文章！</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/JuhFrDbmLMcJB60hfRMyTg">SpingBoot+Freemarker</a></p>
<p> Freemarker不是面向最终用户的，而是一个java类库，可以将其作为以一个普通的组件嵌入到我们产品之中的</p>
<p>模板的后缀为.ftlh</p>
<p><code>FreeMarkerProperties</code>中则配置了<code>Freemarker</code>的基本信息，例如模板位置在 <code>classpath:/templates/</code> ，再例如模板后缀为 <code>.ftlh</code>，那么这些配置我们以后都可以在<code>application.properties</code>中进行修改</p>
<p><img src="/2023/06/28/Springboot/image-20230718011328452.png" srcset="/img/loading.gif" lazyload alt="image-20230718011328452"></p>
<h1 id="freemarker实践"><a href="#freemarker实践" class="headerlink" title="freemarker实践"></a>freemarker实践</h1><p>创建项目时候需要导入模板</p>
<p>选择以下俩项</p>
<p><img src="/2023/06/28/Springboot/image-20230718011335128.png" srcset="/img/loading.gif" lazyload alt="image-20230718011335128"></p>
<p>和thymeleaf有点类似的说实话</p>
<p>如果需要修改模板文件位置，可以在application.properties中进行配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.freemarker.allow-request-override</span>=<span class="hljs-string">false</span><br><span class="hljs-attr">spring.freemarker.allow-session-override</span>=<span class="hljs-string">false</span><br><span class="hljs-attr">spring.freemarker.cache</span>=<span class="hljs-string">false</span><br><span class="hljs-attr">spring.freemarker.charset</span>=<span class="hljs-string">UTF-8</span><br><span class="hljs-attr">spring.freemarker.check-template-location</span>=<span class="hljs-string">true</span><br><span class="hljs-attr">spring.freemarker.content-type</span>=<span class="hljs-string">text/html</span><br><span class="hljs-attr">spring.freemarker.expose-request-attributes</span>=<span class="hljs-string">false</span><br><span class="hljs-attr">spring.freemarker.expose-session-attributes</span>=<span class="hljs-string">false</span><br><span class="hljs-attr">spring.freemarker.suffix</span>=<span class="hljs-string">.ftl</span><br><span class="hljs-attr">spring.freemarker.template-loader-path</span>=<span class="hljs-string">classpath:/templates/</span><br></code></pre></td></tr></table></figure>

<p>配置文件按照顺序依次解释如下：</p>
<ol>
<li>HttpServletRequest的属性是否可以覆盖controller中model的同名项</li>
<li>HttpSession的属性是否可以覆盖controller中model的同名项</li>
<li>是否开启缓存</li>
<li>模板文件编码</li>
<li>是否检查模板位置</li>
<li>Content-Type的值</li>
<li>是否将HttpServletRequest中的属性添加到Model中</li>
<li>是否将HttpSession中的属性添加到Model中</li>
<li>模板文件后缀</li>
<li>模板文件位置</li>
</ol>
<h1 id="Freemarker直接输出值"><a href="#Freemarker直接输出值" class="headerlink" title="Freemarker直接输出值"></a>Freemarker直接输出值</h1><p>可以直接输出的字符串（即不需要转义的）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>$&#123;&quot;hello,我是直接输出的语句&quot;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>需要转义的输出字符串看眼添加r的标记</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>$&#123;r&quot;C:/&quot;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>定义变量语句</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;#assign price=99&gt;<br></code></pre></td></tr></table></figure>

<p>可以看看freemarker的内联语句，同样是十分高效的</p>
<h1 id="认识主流JSON框架"><a href="#认识主流JSON框架" class="headerlink" title="认识主流JSON框架"></a>认识主流JSON框架</h1><p>springMVC框架中，Jackson和gson已经自动配置好了。</p>
<p>HttpMessageConverter</p>
<p>转换器：对象——&gt;json，json——&gt;对象</p>
<p>所有的json工具都会提供各自的HttpMessageConverter</p>
<h1 id="Spring-boot-整合Jackson"><a href="#Spring-boot-整合Jackson" class="headerlink" title="Spring boot 整合Jackson"></a>Spring boot 整合Jackson</h1><h3 id="JsonProperty"><a href="#JsonProperty" class="headerlink" title="@JsonProperty"></a>@JsonProperty</h3><p>指定属性序列化&#x2F;反序列化时的名称，默认名称就是属性名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@JsonProperty(value=&quot;aaaage&quot;,index=99)</span><br><span class="hljs-keyword">private</span> Integer age;<br></code></pre></td></tr></table></figure>

<p>value为属性名称， index是json序列化和反序列化的顺序索引</p>
<h3 id="JsonIgnore"><a href="#JsonIgnore" class="headerlink" title="@JsonIgnore"></a>@JsonIgnore</h3><p>忽略掉相对应的数据</p>
<p>并且序列化和反序列化的时候都会忽略掉该字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@JsonIgnore</span><br><span class="hljs-keyword">private</span> String address;<br></code></pre></td></tr></table></figure>

<h3 id="JsonIgnoreProperties"><a href="#JsonIgnoreProperties" class="headerlink" title="@JsonIgnoreProperties()"></a>@JsonIgnoreProperties()</h3><p>括号中输入value数组，批量忽略数组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@JsonIgnoreProperties(&#123;&quot;birthday&quot;,&quot;address&quot;&#125;)</span><br></code></pre></td></tr></table></figure>

<h3 id="JsonFormat"><a href="#JsonFormat" class="headerlink" title="@JsonFormat()"></a>@JsonFormat()</h3><p>这个是格式化输入数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@JsonFormat(pattern =&quot;yyyy-MM-dd HH:mm:ss&quot;,timezone = &quot;Asia/Shanghai&quot;)</span><br><span class="hljs-keyword">private</span> Date birthday;<br></code></pre></td></tr></table></figure>

<p>日期格式化，timezone是日期格式化</p>
<h3 id="使用MVCConfig进行内置配置"><a href="#使用MVCConfig进行内置配置" class="headerlink" title="使用MVCConfig进行内置配置"></a>使用MVCConfig进行内置配置</h3><p>创建一个WebMvcCofig文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebMvcConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    ObjectMapper <span class="hljs-title function_">objectMapper</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">om</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();<br>        om.setDateFormat(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;yyyy-mm-dd hh:mm:ss&quot;</span>));<br>        <span class="hljs-keyword">return</span>  om;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在config中设置，这样可以避免重复书写，该工程中所有的实体类的时间的格式都会统一成写的pattern。</p>
<h1 id="Spring-boot-整合gson"><a href="#Spring-boot-整合gson" class="headerlink" title="Spring boot 整合gson"></a>Spring boot 整合gson</h1><p>首先需要将jackson的包从maven中排除出去</p>
<p>使用如下代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>添加在dependency中排除相对应的artifactId的jar包</p>
<p>然后添加gson的依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.google.code.gson<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>gson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>gson的格式可以在application中进行配置</p>
<h3 id="properties配置"><a href="#properties配置" class="headerlink" title="properties配置"></a>properties配置</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.gson.date-format</span>=<span class="hljs-string">yyyy-mm-dd hh:mm:ss</span><br><span class="hljs-comment">#是否禁用HTML的转义字符</span><br><span class="hljs-attr">spring.gson.disable-html-escaping</span>=<span class="hljs-string">true</span><br><span class="hljs-comment">#序列化时是否排除内部类</span><br><span class="hljs-attr">spring.gson.disable-inner-class-serialization</span>=<span class="hljs-string">false</span><br><span class="hljs-comment">#序列化时是否启用复杂映射键</span><br><span class="hljs-attr">spring.gson.enable-complex-map-key-serialization</span>=<span class="hljs-string"></span><br><span class="hljs-comment">#是否排除没有@Expose 注解的字段</span><br><span class="hljs-attr">spring.gson.exclude-fields-without-expose-annotation</span>=<span class="hljs-string"></span><br><span class="hljs-comment">#序列化时字段名的命名策略</span><br><span class="hljs-attr">spring.gson.field-naming-policy</span>=<span class="hljs-string"></span><br><span class="hljs-comment">#在输出前添加一些特殊的文本来生成一个不可执行的json</span><br><span class="hljs-attr">spring.gson.generate-non-executable-json</span>=<span class="hljs-string"></span><br><span class="hljs-comment">#是否序列化空字段</span><br><span class="hljs-attr">spring.gson.serialize-nulls</span>=<span class="hljs-string"></span><br></code></pre></td></tr></table></figure>

<p>或者也可以使用</p>
<h3 id="WebMvcConfig配置"><a href="#WebMvcConfig配置" class="headerlink" title="WebMvcConfig配置"></a>WebMvcConfig配置</h3><p>会重载原本的处理方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebMvcConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    GsonBuilder <span class="hljs-title function_">gsonBuilder</span><span class="hljs-params">()</span>&#123;<br>        GsonBuilder gsonBuilder=<span class="hljs-keyword">new</span> <span class="hljs-title class_">GsonBuilder</span>();<br>        gsonBuilder.setDateFormat(<span class="hljs-string">&quot;yyyy-mm-dd hh:mm:ss&quot;</span>);<br>        <span class="hljs-keyword">return</span> gsonBuilder;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Spring-boot-处理静态资源"><a href="#Spring-boot-处理静态资源" class="headerlink" title="Spring boot 处理静态资源"></a>Spring boot 处理静态资源</h1><p><img src="/2023/06/28/Springboot/image-20230718011347239.png" srcset="/img/loading.gif" lazyload alt="image-20230718011347239"></p>
<p>springboot的静态资源默认存放在static下</p>
<p>并且访问静态资源时不需要添加static</p>
<p>静态资源放置的位置：</p>
<ol>
<li>&#x2F;META-INF&#x2F;resources&#x2F;</li>
<li>&#x2F;resources&#x2F;</li>
<li>&#x2F;static&#x2F;</li>
<li>&#x2F;public&#x2F;</li>
<li>在webapp下直接放置（十分不常用）</li>
</ol>
<p><mark>优先级从上向下降低</mark></p>
<h1 id="自定义静态资源配置"><a href="#自定义静态资源配置" class="headerlink" title="自定义静态资源配置"></a>自定义静态资源配置</h1><p>如果没有配置，直接访问resources中的资源会被拦截，并且报错404</p>
<h3 id="properties-文件配置"><a href="#properties-文件配置" class="headerlink" title="properties 文件配置"></a>properties 文件配置</h3><p>这时候就需要手动配置以下文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.web.resources.static-locations</span>=<span class="hljs-string">classpath:/</span><br><span class="hljs-attr">spring.mvc.static-path-pattern</span>=<span class="hljs-string">/**</span><br></code></pre></td></tr></table></figure>

<p><mark>第一行配置表示定义资源位置，第二行配置表示定义请求 URL 规则</mark></p>
<p><img src="/2023/06/28/Springboot/image-20230718011355193.png" srcset="/img/loading.gif" lazyload alt="image-20230718011355193"></p>
<p>这样能够通过访问localhost:8080&#x2F;javaboy&#x2F;01.html</p>
<p>如果在properties下配置的是classpath:&#x2F;javaboy&#x2F;  </p>
<p>那么需要访问localhost:8080&#x2F;01.html</p>
<h3 id="Java代码配置"><a href="#Java代码配置" class="headerlink" title="Java代码配置"></a>Java代码配置</h3><p>创建一个WebMvcConfig.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addResourceHandlers</span><span class="hljs-params">(ResourceHandlerRegistry registry)</span> &#123;<br>        registry.addResourceHandler(<span class="hljs-string">&quot;/xg/**&quot;</span>).addResourceLocations(<span class="hljs-string">&quot;classpath:/xgfm/&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p> 用java代码进行配置的意思就是用addResourceHandler的内容来映射addResourceLocations的内容。</p>
<p>在上面里的例子中，即可通过访问  localhost:8080&#x2F;xg&#x2F;01.html来访问resources下的xgfm包中的01.html静态资源</p>
<h1 id="Spring-boot单文件上传"><a href="#Spring-boot单文件上传" class="headerlink" title="Spring boot单文件上传"></a>Spring boot单文件上传</h1><p>&#x2F;&#x2F;该内容用static_resources的工程文件一起练习</p>
<p>首先写一个提交文件的页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/upload&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>写一个controller处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileUploadController</span> &#123;<br>    SimpleDateFormat sdf=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;/yyyy/mm/dd/&quot;</span>);<br>    <span class="hljs-meta">@PostMapping(&quot;/upload&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">upload</span><span class="hljs-params">(MultipartFile file, HttpServletRequest request)</span>&#123;<br>        <span class="hljs-comment">//获取临时目录</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">realPath</span> <span class="hljs-operator">=</span> request.getServletContext().getRealPath(<span class="hljs-string">&quot;/&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">format</span> <span class="hljs-operator">=</span> sdf.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        String path=realPath+ format;<br>        File folder=<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(path);<br>        <span class="hljs-keyword">if</span> (!folder.exists())&#123;<br>            folder.mkdirs();<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">oldName</span> <span class="hljs-operator">=</span> file.getOriginalFilename();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">newName</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString()+oldName.substring(oldName.lastIndexOf(<span class="hljs-string">&quot;.&quot;</span>));<br>        <span class="hljs-keyword">try</span> &#123;<br>            file.transferTo(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(folder,newName));<br>            String s=request.getScheme()+<span class="hljs-string">&quot;://&quot;</span>+request.getServerName()+<span class="hljs-string">&quot;:&quot;</span>+request.getServerPort()+format+newName;<br>            <span class="hljs-keyword">return</span> s;<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>同时，还可以在properties中配置其他信息</p>
<p>比如限制单个文件的大小和限制所有文件的大小</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.servlet.multipart.max-file-size</span>=<span class="hljs-string">1MB</span><br><span class="hljs-attr">spring.servlet.multipart.max-request-size</span>=<span class="hljs-string">10MB</span><br></code></pre></td></tr></table></figure>

<h1 id="Spring-boot多文件上传"><a href="#Spring-boot多文件上传" class="headerlink" title="Spring boot多文件上传"></a>Spring boot多文件上传</h1><h3 id="合并多文件"><a href="#合并多文件" class="headerlink" title="合并多文件"></a>合并多文件</h3><p>在controller的形参中用数组接受输入的文件，再用for循环遍历</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileUploadController2</span> &#123;<br>    SimpleDateFormat sdf=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;/yyyy/mm/dd/&quot;</span>);<br>    <span class="hljs-meta">@PostMapping(&quot;/upload2&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">upload</span><span class="hljs-params">(MultipartFile[] files, HttpServletRequest request)</span>&#123;<br>        <span class="hljs-comment">//获取临时目录</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">realPath</span> <span class="hljs-operator">=</span> request.getServletContext().getRealPath(<span class="hljs-string">&quot;/&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">format</span> <span class="hljs-operator">=</span> sdf.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        String path=realPath+ format;<br>        File folder=<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(path);<br>        <span class="hljs-keyword">if</span> (!folder.exists())&#123;<br>            folder.mkdirs();<br>        &#125;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">for</span> (MultipartFile file : files) &#123;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">oldName</span> <span class="hljs-operator">=</span> file.getOriginalFilename();<br>                <span class="hljs-type">String</span> <span class="hljs-variable">newName</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString()+oldName.substring(oldName.lastIndexOf(<span class="hljs-string">&quot;.&quot;</span>));<br>                    file.transferTo(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(folder,newName));<br>                    String s=request.getScheme()+<span class="hljs-string">&quot;://&quot;</span>+request.getServerName()+<span class="hljs-string">&quot;:&quot;</span>+request.getServerPort()+format+newName;<br>                System.out.println(s);<br>                    <span class="hljs-keyword">return</span> s;<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="独立多文件"><a href="#独立多文件" class="headerlink" title="独立多文件"></a>独立多文件</h3><p>controller如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileUploadController3</span> &#123;<br>    SimpleDateFormat sdf=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;/yyyy/mm/dd/&quot;</span>);<br>    <span class="hljs-meta">@PostMapping(&quot;/upload3&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">upload</span><span class="hljs-params">(MultipartFile file1, MultipartFile file2,HttpServletRequest request)</span>&#123;<br>        <span class="hljs-comment">//获取临时目录</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">realPath</span> <span class="hljs-operator">=</span> request.getServletContext().getRealPath(<span class="hljs-string">&quot;/&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">format</span> <span class="hljs-operator">=</span> sdf.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        String path=realPath+ format;<br>        File folder=<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(path);<br>        <span class="hljs-keyword">if</span> (!folder.exists())&#123;<br>            folder.mkdirs();<br>        &#125;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">oldName1</span> <span class="hljs-operator">=</span> file1.getOriginalFilename();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">newName1</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString() + oldName1.substring(oldName1.lastIndexOf(<span class="hljs-string">&quot;.&quot;</span>));<br>            file1.transferTo(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(folder, newName1));<br>            <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> request.getScheme() + <span class="hljs-string">&quot;://&quot;</span> + request.getServerName() + <span class="hljs-string">&quot;:&quot;</span> + request.getServerPort() + format + newName1;<br>            System.out.println(s);<br><br>            <span class="hljs-type">String</span> <span class="hljs-variable">oldName2</span> <span class="hljs-operator">=</span> file2.getOriginalFilename();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">newName2</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString()+oldName2.substring(oldName1.lastIndexOf(<span class="hljs-string">&quot;.&quot;</span>));<br>            file1.transferTo(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(folder,newName2));<br>            String s2=request.getScheme()+<span class="hljs-string">&quot;://&quot;</span>+request.getServerName()+<span class="hljs-string">&quot;:&quot;</span>+request.getServerPort()+format+newName2;<br>            System.out.println(s2);<br><br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Spring-boot-AJAX文件上传"><a href="#Spring-boot-AJAX文件上传" class="headerlink" title="Spring boot+AJAX文件上传"></a>Spring boot+AJAX文件上传</h1><p>与之前类似，但需要记得配置jq的script，以及编写函数时不要出现错误。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://code.jquery.com/jquery-3.7.0.js&quot;</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">&quot;sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=&quot;</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;result&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;上传&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;uploadFile()&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;JavaScript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">uploadFile</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> file = $(<span class="hljs-string">&quot;#file&quot;</span>)[<span class="hljs-number">0</span>].<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> formData =<span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();</span><br><span class="language-javascript">        formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">&quot;file&quot;</span>,file);</span><br><span class="language-javascript">        $.<span class="hljs-title function_">ajax</span>(&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>:<span class="hljs-string">&#x27;post&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;/upload&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">processData</span>:<span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">contentType</span>:<span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">data</span>:formData,</span><br><span class="language-javascript">            <span class="hljs-attr">success</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">msg</span>) &#123;</span><br><span class="language-javascript">                $(<span class="hljs-string">&quot;#result&quot;</span>).<span class="hljs-title function_">html</span>(msg);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="ControllerAdvice注解的使用"><a href="#ControllerAdvice注解的使用" class="headerlink" title="ControllerAdvice注解的使用"></a>ControllerAdvice注解的使用</h1><p>练习在controlleradvice和static_resources中</p>
<p>@ControllerAdvice有三方面的功能：</p>
<ol>
<li>全局异常处理</li>
<li>全局数据绑定</li>
<li>全局数据预处理</li>
</ol>
<h3 id="全局异常处理"><a href="#全局异常处理" class="headerlink" title="全局异常处理"></a>全局异常处理</h3><p>分别有以下俩种形式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-comment">//该注解返回页面、视图</span><br><span class="hljs-meta">@RestControllerAdvice</span><br><span class="hljs-comment">//该注解可以返回一段字符串或者json</span><br></code></pre></td></tr></table></figure>

<p> 这里使用第二种进行练习</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyGlobalException</span> &#123;<br><span class="hljs-comment">//    @ExceptionHandler(Exception.class)</span><br><span class="hljs-comment">//    public String customException(Exception e)&#123;</span><br><span class="hljs-comment">//        return e.getMessage();</span><br><span class="hljs-comment">//    &#125;</span><br><br>    <span class="hljs-meta">@ExceptionHandler(Exception.class)</span><br>    <span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title function_">customException</span><span class="hljs-params">(Exception e)</span>&#123;<br>        <span class="hljs-type">ModelAndView</span> <span class="hljs-variable">mv</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>(<span class="hljs-string">&quot;javaboy&quot;</span>);<br>        mv.addObject(<span class="hljs-string">&quot;error&quot;</span>,e.getMessage());<br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="全局数据绑定"><a href="#全局数据绑定" class="headerlink" title="全局数据绑定"></a>全局数据绑定</h3><p>ModelAttribute</p>
<p>后面用到了ModelAttribute注解，主要有两个作用</p>
<ol>
<li>在数据回显时，给变量定义别名</li>
<li>定义全局数据</li>
</ol>
<p>当用户访问当前Controller中的任意一个方法，在返回数据时，都会将添加了@ModelAttribute注解的方法的返回值，一起返回给前端</p>
<p>编写自定义的Data类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyGlobalData</span> &#123;<br>    <span class="hljs-meta">@ModelAttribute</span><br>    <span class="hljs-keyword">public</span> Map&lt;String,String&gt; <span class="hljs-title function_">mydata</span><span class="hljs-params">()</span>&#123;<br>        Map&lt;String,String&gt;info=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        info.put(<span class="hljs-string">&quot;username&quot;</span>,<span class="hljs-string">&quot;javaboy&quot;</span>);<br>        info.put(<span class="hljs-string">&quot;address&quot;</span>,<span class="hljs-string">&quot;www.javaboy.org&quot;</span>);<br>        <span class="hljs-keyword">return</span> info;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如此一来info便成为了全局变量，在hellocontroller中便可以进行调用了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hello</span><span class="hljs-params">(Model model)</span>&#123;<br>        Map&lt;String,Object&gt;asMap=model.asMap();<br>        Map&lt;String,String&gt; info = (Map&lt;String, String&gt;) asMap.get(<span class="hljs-string">&quot;map&quot;</span>);<br>        Set&lt;String&gt; keySet=info.keySet();<br>        <span class="hljs-keyword">for</span> (String s:keySet)&#123;<br>            System.out.println(s+<span class="hljs-string">&quot;+---+&quot;</span>+info.get(s));<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="请求全局数据预处理"><a href="#请求全局数据预处理" class="headerlink" title="请求全局数据预处理"></a>请求全局数据预处理</h3><p>在发送请求时，可能遇到接口设计不当导致，出现命名冲突，此时可以通过全局数据预处理进行修复。</p>
<p>controllerAdvice</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyGlobalData</span> &#123;<br>    <span class="hljs-meta">@InitBinder(&quot;a&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">a</span><span class="hljs-params">(WebDataBinder binder)</span>&#123;<br>        binder.setFieldDefaultPrefix(<span class="hljs-string">&quot;a.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@InitBinder(&quot;b&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">b</span><span class="hljs-params">(WebDataBinder binder)</span>&#123;<br>        binder.setFieldDefaultPrefix(<span class="hljs-string">&quot;b.&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对应的controller类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BookController</span> &#123;<br>    <span class="hljs-meta">@PostMapping(&quot;/book&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addBook</span><span class="hljs-params">(<span class="hljs-meta">@ModelAttribute(&quot;b&quot;)</span> Book book,<span class="hljs-meta">@ModelAttribute(&quot;a&quot;)</span> Author author)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;book=&quot;</span>+book);<br>        System.out.println(<span class="hljs-string">&quot;author=&quot;</span>+author);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="异常页面定义"><a href="#异常页面定义" class="headerlink" title="异常页面定义"></a>异常页面定义</h1><p>404问题自动寻找异常页面的优先级，其他同理</p>
<p>（精确高于模糊，动态高于静态）</p>
<ol>
<li>templates&#x2F;error&#x2F;404.html</li>
<li>static&#x2F;error&#x2F;404.html</li>
<li>templates&#x2F;error&#x2F;4xx.html</li>
<li>static&#x2F;error&#x2F;4xx.html</li>
</ol>
<p><img src="/2023/06/28/Springboot/image-20230718011427893.png" srcset="/img/loading.gif" lazyload alt="image-20230718011427893"></p>
<h3 id="动态定义异常页面"><a href="#动态定义异常页面" class="headerlink" title="动态定义异常页面"></a>动态定义异常页面</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>500-templates<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>path<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;path&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>error<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;error&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>message<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;message&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>timestamp<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;timestamp&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>status<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;status&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>这样可以将异常以表格的方式输出到前端页面。</p>
<h1 id="自定义异常"><a href="#自定义异常" class="headerlink" title="自定义异常"></a>自定义异常</h1><p>通常是不需要的，因为springboot提供的异常已经足够使用了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyErrorAttributes</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">DefaultErrorAttributes</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title function_">getErrorAttributes</span><span class="hljs-params">(WebRequest webRequest, ErrorAttributeOptions options)</span> &#123;<br>        Map&lt;String, Object&gt; map = <span class="hljs-built_in">super</span>.getErrorAttributes(webRequest, options);<br>        <span class="hljs-keyword">if</span> ((Integer) map.get(<span class="hljs-string">&quot;status&quot;</span>)==<span class="hljs-number">404</span>)&#123;<br>            map.put(<span class="hljs-string">&quot;message&quot;</span>,<span class="hljs-string">&quot;页面不存在&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> map;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>首先继承DefaultErrorAttributes然后根据现呈的数据进行定义修改或者添加，一般是没有必要去重写BasicErrorController。</p>
<p>同时也可以去自定义视图。</p>
<h1 id="跨域问题"><a href="#跨域问题" class="headerlink" title="跨域问题"></a>跨域问题</h1><p>明确了解域的概念</p>
<p>域：协议+域名&#x2F;IP+端口</p>
<p>如果三个中有不一样的，则说明跨域了。</p>
<h3 id="方法一：添加注解"><a href="#方法一：添加注解" class="headerlink" title="方法一：添加注解"></a>方法一：添加注解</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@CrossOrigin(value = &quot;http://localhost:8081&quot;,maxAge = 1800)</span><br></code></pre></td></tr></table></figure>

<p>其后可以添加限制条件等其他</p>
<p>添加在类上说明类中的所有方法都可以，在方法上则对单独的方法有效</p>
<h3 id="方法二：编写WebMvcConfig"><a href="#方法二：编写WebMvcConfig" class="headerlink" title="方法二：编写WebMvcConfig"></a>方法二：编写WebMvcConfig</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCorsMappings</span><span class="hljs-params">(CorsRegistry registry)</span> &#123;<br>        registry.addMapping(<span class="hljs-string">&quot;/**&quot;</span>)<br>                .allowedHeaders(<span class="hljs-string">&quot;*&quot;</span>)<br>                .allowedMethods(<span class="hljs-string">&quot;*&quot;</span>)<br>                .allowedOrigins(<span class="hljs-string">&quot;http://localhost:8081&quot;</span>)<br>                .maxAge(<span class="hljs-number">1800</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>编写config组件，修改响应头</p>
<h3 id="方法三：注入corsfilter"><a href="#方法三：注入corsfilter" class="headerlink" title="方法三：注入corsfilter"></a>方法三：注入corsfilter</h3><p>使用Bean注释，将corsFilter注入到spring容器之中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br><span class="hljs-comment">//    @Override</span><br><span class="hljs-comment">//    public void addCorsMappings(CorsRegistry registry) &#123;</span><br><span class="hljs-comment">//        registry.addMapping(&quot;/**&quot;)</span><br><span class="hljs-comment">//                .allowedHeaders(&quot;*&quot;)</span><br><span class="hljs-comment">//                .allowedMethods(&quot;*&quot;)</span><br><span class="hljs-comment">//                .allowedOrigins(&quot;http://localhost:8081&quot;)</span><br><span class="hljs-comment">//                .maxAge(1800);</span><br><span class="hljs-comment">//    &#125;</span><br>    <span class="hljs-meta">@Bean</span><br>    CorsFilter <span class="hljs-title function_">corsFilter</span><span class="hljs-params">()</span>&#123;<br>        UrlBasedCorsConfigurationSource source=<span class="hljs-keyword">new</span> <span class="hljs-title class_">UrlBasedCorsConfigurationSource</span>();<br>        CorsConfiguration cfg=<span class="hljs-keyword">new</span> <span class="hljs-title class_">CorsConfiguration</span>();<br>        cfg.addAllowedOrigin(<span class="hljs-string">&quot;http://localhost:8081&quot;</span>);<br>        cfg.addAllowedMethod(<span class="hljs-string">&quot;*&quot;</span>);<br>        source.registerCorsConfiguration(<span class="hljs-string">&quot;/**&quot;</span>,cfg);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CorsFilter</span>(source);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Spring-boot导入XML配置"><a href="#Spring-boot导入XML配置" class="headerlink" title="Spring boot导入XML配置"></a>Spring boot导入XML配置</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ImportResource(&quot;classpath:beans.xml&quot;)</span><br></code></pre></td></tr></table></figure>

<p>在Application中输入如上的注释即可完成，注入。</p>
<h1 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h1><p>与过滤器比较像，我们可以使用拦截器做很多工作</p>
<ul>
<li>日志记录</li>
<li>权限检查</li>
<li>性能监控</li>
<li>….</li>
</ul>
<p>拦截器类编写</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.interceptor;<br><br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br><br>    <span class="hljs-comment">//该方法返回false，请求将不再继续往下走，所有将默认的false改成true</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;preHandle&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//controller被执行之后被调用</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;postHandle&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">//当preHandle方法返回true，该方法才会执行，可以进行一些清理操作等</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;afterCompletion&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>preHandle<ul>
<li>返回false，请求将不再继续执行</li>
</ul>
</li>
<li>postHandle<ul>
<li>Controller执行之后被调用</li>
</ul>
</li>
<li>afterCompletion<ul>
<li>preHandle返回true才会执行</li>
</ul>
</li>
</ul>
<p>然后配置WebMvcConfig</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.interceptor;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> &#123;<br>        registry.addInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyInterceptor</span>()).addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>).excludePathPatterns(<span class="hljs-string">&quot;/hello&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>addPathPatterns为添加拦截路径。</p>
<p>excludePathPatterns为添加白名单。</p>
<p>最后使用HelloController进行测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.interceptor;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello interceptor&quot;</span>;<br>    &#125;<br>    <span class="hljs-meta">@GetMapping(&quot;/hello2&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello2</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello2 interceptor&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>当访问hello时，并没控制台输出</p>
<p>当访问hello2时，控制输出如下</p>
<p>preHandle<br>postHandle<br>afterCompletion</p>
<p>即调用了拦截器</p>
<h1 id="系统启动任务"><a href="#系统启动任务" class="headerlink" title="系统启动任务"></a>系统启动任务</h1><h3 id="CommandLineRunner"><a href="#CommandLineRunner" class="headerlink" title="CommandLineRunner"></a>CommandLineRunner</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Order(100)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCommandLineRunner01</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CommandLineRunner</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(String... args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;args1 = &quot;</span> + Arrays.toString(args));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Order(99)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCommandLineRunner02</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CommandLineRunner</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(String... args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;args2 = &quot;</span> + Arrays.toString(args));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>开机自启动任务</p>
<h3 id="ApplicationRunner"><a href="#ApplicationRunner" class="headerlink" title="ApplicationRunner"></a>ApplicationRunner</h3><p>与commandLineRunner一起进行练习，因为比较相似。</p>
<p>二者功能和用法是类似的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Order(98)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplicationRunner</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ApplicationRunner</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(ApplicationArguments args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        List&lt;String&gt; nonOptionArgs = args.getNonOptionArgs();<br>        System.out.println(<span class="hljs-string">&quot;nonOptionArgs1 = &quot;</span> + nonOptionArgs);<br>        Set&lt;String&gt; optionNames = args.getOptionNames();<br>        <span class="hljs-keyword">for</span> (String optionName : optionNames) &#123;<br>            System.out.println(optionName + <span class="hljs-string">&quot;-1-&gt;&quot;</span> + args.getOptionValues(optionName));<br>        &#125;<br>        String[] sourceArgs = args.getSourceArgs();<br>        System.out.println(<span class="hljs-string">&quot;sourceArgs1 = &quot;</span> + Arrays.toString(sourceArgs));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Springboot-Web组件"><a href="#Springboot-Web组件" class="headerlink" title="Springboot+Web组件"></a>Springboot+Web组件</h1><h3 id="Servlet类"><a href="#Servlet类" class="headerlink" title="Servlet类"></a>Servlet类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(urlPatterns = &quot;/hello&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        <span class="hljs-built_in">super</span>.doGet(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doPost</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyServlet&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Filter类"><a href="#Filter类" class="headerlink" title="Filter类"></a>Filter类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebFilter(urlPatterns = &quot;/*&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Filter</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyFilter&quot;</span>);<br>        chain.doFilter(request,response);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Listener类"><a href="#Listener类" class="headerlink" title="Listener类"></a>Listener类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebListener</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyListener</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RequestContextListener</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">requestInitialized</span><span class="hljs-params">(ServletRequestEvent requestEvent)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;requestInitialized&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">requestDestroyed</span><span class="hljs-params">(ServletRequestEvent requestEvent)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;requestDestroyed&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Application中扫描"><a href="#Application中扫描" class="headerlink" title="Application中扫描"></a>Application中扫描</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@ServletComponentScan(&quot;com.xgfm.webcomponent&quot;)</span> <span class="hljs-comment">//扫描包名</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebcomponentApplication</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;        SpringApplication.run(WebcomponentApplication.class, args);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Spring-boot注册过滤器"><a href="#Spring-boot注册过滤器" class="headerlink" title="Spring boot注册过滤器"></a>Spring boot注册过滤器</h1><h3 id="使用WebFilter和Component注解"><a href="#使用WebFilter和Component注解" class="headerlink" title="使用WebFilter和Component注解"></a>使用WebFilter和Component注解</h3><p>但是这样无法定义Filter的优先级</p>
<h3 id="使用Component注解"><a href="#使用Component注解" class="headerlink" title="使用Component注解"></a>使用Component注解</h3><p>单单使用Component注解，然后使用Order进行配置优先级。但这样无法配置路径，只能拦截所有的路径</p>
<h3 id="使用FilterConfiguration类和Bean注解"><a href="#使用FilterConfiguration类和Bean注解" class="headerlink" title="使用FilterConfiguration类和Bean注解"></a>使用FilterConfiguration类和Bean注解</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FilterConfiguration</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    FilterRegistrationBean&lt;MyFilter04&gt; <span class="hljs-title function_">filter04FilterRegistrationBean04</span><span class="hljs-params">()</span>&#123;<br>        FilterRegistrationBean&lt;MyFilter04&gt; bean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FilterRegistrationBean</span>&lt;&gt;();<br>        bean.setOrder(<span class="hljs-number">90</span>);<br>        bean.setFilter(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyFilter04</span>());<br>        bean.setUrlPatterns(Arrays.asList(<span class="hljs-string">&quot;/*&quot;</span>));<br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br>    <span class="hljs-meta">@Bean</span><br>    FilterRegistrationBean&lt;MyFilter05&gt; <span class="hljs-title function_">filter05FilterRegistrationBean05</span><span class="hljs-params">()</span>&#123;<br>        FilterRegistrationBean&lt;MyFilter05&gt; bean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FilterRegistrationBean</span>&lt;&gt;();<br>        bean.setOrder(<span class="hljs-number">89</span>);<br>        bean.setFilter(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyFilter05</span>());<br>        bean.setUrlPatterns(Arrays.asList(<span class="hljs-string">&quot;/*&quot;</span>));<br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>filter正常编写</p>
<h1 id="Springboot路径映射"><a href="#Springboot路径映射" class="headerlink" title="Springboot路径映射"></a>Springboot路径映射</h1><p>使用WebMvcConfig进行配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> &#123;<br>        registry.addViewController(<span class="hljs-string">&quot;/02&quot;</span>).setViewName(<span class="hljs-string">&quot;02&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>使用对应的add方法添加路径进行映射，但这样存在缺陷，其中Model配置的模板无法渲染动态化的数据，会导致页面为静态页面。</p>
<h1 id="参数类型转换"><a href="#参数类型转换" class="headerlink" title="参数类型转换"></a>参数类型转换</h1><p>练习内容为usermanager</p>
<p>如果正常写并且使用controller如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br>    <span class="hljs-meta">@PostMapping(&quot;/user1&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addUser</span><span class="hljs-params">(User user)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;user= &quot;</span>+user);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>会导致400错误，因为输入数据无法成为user类的实体对象传入，这时候就要定义一个转换器。</p>
<p>MyDataConverter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyDataConverter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Converter</span>&lt;String,Date&gt; &#123;<br>    SimpleDateFormat sdf=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;yyyy-mm-dd&quot;</span>);<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Date <span class="hljs-title function_">convert</span><span class="hljs-params">(String source)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> sdf.parse(source);<br>        &#125; <span class="hljs-keyword">catch</span> (ParseException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对输入的一个数据进行转换，使得controller能够接受，然后进入adduser方法</p>
<p>出现如下传参方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/user2&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addUser2</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;user= &quot;</span>+user);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>@RequestBody该注释就要使用json格式传入。</p>
<p><mark>post请求，参数可以是key&#x2F;value形式，也可以是json形式.自定义的类型转换器对key&#x2F;value形式的参数有效。json形式的参数，不需要类型转换器。json字符串是通过HttpMessageConverter转换为User对象</mark></p>
<h1 id="自定义项目首页和角标"><a href="#自定义项目首页和角标" class="headerlink" title="自定义项目首页和角标"></a>自定义项目首页和角标</h1><p>优先找静态然后再找动态，配置webmvcconfig如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> &#123;<br>        registry.addViewController(<span class="hljs-string">&quot;/index&quot;</span>).setViewName(<span class="hljs-string">&quot;index&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>角标就在五个放置资源的地方放一个<code>favicon.ico</code>即可，不需要其他的配置</p>
<h1 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h1><p>练习在welcomepage之中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.welcomepage;<br><br><span class="hljs-keyword">import</span> org.aspectj.lang.JoinPoint;<br><span class="hljs-keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;<br><span class="hljs-keyword">import</span> org.aspectj.lang.annotation.*;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Aspect</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogAspect</span> &#123;<br>    <span class="hljs-meta">@Pointcut(&quot;execution(* com.xgfm.welcomepage.UserService.*.*(..))&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pc1</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br>    <span class="hljs-meta">@Before(&quot;pc1()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">before</span><span class="hljs-params">(JoinPoint jp)</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span>jp.getSignature().getName();<br>        System.out.println(name+<span class="hljs-string">&quot;方法开始执行了&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@After(&quot;pc1()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">After</span><span class="hljs-params">(JoinPoint jp)</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span>jp.getSignature().getName();<br>        System.out.println(name+<span class="hljs-string">&quot;方法执行结束了&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@AfterReturning(value = &quot;pc1()&quot;,returning = &quot;s&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterReturning</span><span class="hljs-params">(JoinPoint jp,String s)</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> jp.getSignature().getName();<br>        System.out.println(name + <span class="hljs-string">&quot;方法返回值是 &quot;</span> + s);<br>    &#125;<br><br>    <span class="hljs-meta">@AfterThrowing(value = &quot;pc1()&quot;,throwing = &quot;e&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterThrowing</span><span class="hljs-params">(JoinPoint jp,Exception e)</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> jp.getSignature().getName();<br>        System.out.println(name + <span class="hljs-string">&quot;方法抛出了异常 &quot;</span> + e);<br>    &#125;<br><br>    <span class="hljs-meta">@Around(&quot;pc1()&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">around</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">proceed</span> <span class="hljs-operator">=</span> pjp.proceed();<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h1 id="jdbcTemplate"><a href="#jdbcTemplate" class="headerlink" title="jdbcTemplate"></a>jdbcTemplate</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.48<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>再给一下mysql驱动。</p>
<p>首先需要在application.properties中配置一下数据库的基本信息</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.datasource.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.datasource.password</span>=<span class="hljs-string">1234</span><br><span class="hljs-attr">spring.datasource.url</span>=<span class="hljs-string">jdbc:mysql:///test01?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false</span><br><br></code></pre></td></tr></table></figure>

<p>另外上述配置完，我的电脑依旧会报错，然后我另外添加了这个</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.datasource.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br></code></pre></td></tr></table></figure>

<p>结果就能够运行了</p>
<p>编写的service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.jdbctemplate.service;<br><br><span class="hljs-keyword">import</span> com.xgfm.jdbctemplate.model.User;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.PreparedStatementCreator;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.RowMapper;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.support.GeneratedKeyHolder;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-keyword">import</span> java.sql.*;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    JdbcTemplate jdbcTemplate;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">addUser</span><span class="hljs-params">(User user)</span>&#123;<br>        <span class="hljs-type">int</span> result=jdbcTemplate.update(<span class="hljs-string">&quot;insert into user (username,address) values(?,?)&quot;</span>,user.getUsername(),user.getAddress());<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">addUser2</span><span class="hljs-params">(User user)</span>&#123;<br>        GeneratedKeyHolder keyHolder=<span class="hljs-keyword">new</span> <span class="hljs-title class_">GeneratedKeyHolder</span>();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">update</span> <span class="hljs-operator">=</span> jdbcTemplate.update(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PreparedStatementCreator</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> PreparedStatement <span class="hljs-title function_">createPreparedStatement</span><span class="hljs-params">(Connection con)</span> <span class="hljs-keyword">throws</span> SQLException &#123;<br>                <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">ps</span> <span class="hljs-operator">=</span> con.prepareStatement(<span class="hljs-string">&quot;insert into user (username,address) values(?,?)&quot;</span>, Statement.RETURN_GENERATED_KEYS);<br>                ps.setString(<span class="hljs-number">1</span>, user.getUsername());<br>                ps.setString(<span class="hljs-number">2</span>, user.getAddress());<br>                <span class="hljs-keyword">return</span> ps;<br>            &#125;<br>        &#125;, keyHolder);<br>        user.setId(keyHolder.getKey().longValue());<br>        <span class="hljs-keyword">return</span> update;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">deleteById</span><span class="hljs-params">(Long id)</span>&#123;<br>        <span class="hljs-keyword">return</span> jdbcTemplate.update(<span class="hljs-string">&quot;delete from user where id=?&quot;</span>,id);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">updateById</span><span class="hljs-params">(Long id,String username)</span>&#123;<br>        <span class="hljs-keyword">return</span> jdbcTemplate.update(<span class="hljs-string">&quot;update user set username=? where id = ?&quot;</span>,username,id);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">getAllUsers</span><span class="hljs-params">()</span>&#123;<br>        List&lt;User&gt; query = jdbcTemplate.query(<span class="hljs-string">&quot;select * from user&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">RowMapper</span>&lt;User&gt;() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> User <span class="hljs-title function_">mapRow</span><span class="hljs-params">(ResultSet resultSet, <span class="hljs-type">int</span> rowNum)</span> <span class="hljs-keyword">throws</span> SQLException &#123;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">&quot;username&quot;</span>);<br>                <span class="hljs-type">String</span> <span class="hljs-variable">address</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">&quot;address&quot;</span>);<br>                <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">&quot;id&quot;</span>);<br>                <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>                user.setAddress(address);<br>                user.setUsername(username);<br>                user.setId(Long.parseLong(id));<br>                <span class="hljs-keyword">return</span> user;<br>            &#125;<br>        &#125;);<br>        <span class="hljs-keyword">return</span> query;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>





<p>并且运用test进行测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.jdbctemplate;<br><br><span class="hljs-keyword">import</span> com.xgfm.jdbctemplate.model.User;<br><span class="hljs-keyword">import</span> com.xgfm.jdbctemplate.service.UserService;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">JdbctemplateApplicationTests</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    UserService userService;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoads</span><span class="hljs-params">()</span> &#123;<br>        User user=<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setUsername(<span class="hljs-string">&quot;xgfm&quot;</span>);<br>        user.setAddress(<span class="hljs-string">&quot;xgfmccc&quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> userService.addUser(user);<br>        System.out.println(i);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>        User user=<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setUsername(<span class="hljs-string">&quot;lxm&quot;</span>);<br>        user.setAddress(<span class="hljs-string">&quot;xiaomengege&quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> userService.addUser2(user);<br>        System.out.println(<span class="hljs-string">&quot;i= &quot;</span>+i);<br>        System.out.println(<span class="hljs-string">&quot;user.getId()= &quot;</span>+user.getId());<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span>&#123;<br>        userService.deleteById(<span class="hljs-number">9L</span>);<br>        userService.updateById(<span class="hljs-number">5L</span>,<span class="hljs-string">&quot;lxm&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test3</span><span class="hljs-params">()</span>&#123;<br>        List&lt;User&gt; allUsers = userService.getAllUsers();<br>        <span class="hljs-keyword">for</span> (User allUser : allUsers) &#123;<br>            System.out.println(allUser.toString());<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>这部分与jbdc非常类似，所以就不额外再记录什么了</p>
<h1 id="jdbcTemplate多数据源"><a href="#jdbcTemplate多数据源" class="headerlink" title="jdbcTemplate多数据源"></a>jdbcTemplate多数据源</h1><p><img src="/2023/06/28/Springboot/image-20230718011443733.png" srcset="/img/loading.gif" lazyload alt="image-20230718011443733"></p>
<p>像这样配置2个，用two和one加在中间进行区分，然后配置DataSourceConfig和JdbcTemplateConfig进行导入配置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.jdbctemplatemulti.config;<br><br><span class="hljs-keyword">import</span> com.zaxxer.hikari.HikariDataSource;<br><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-meta">@ConfigurationProperties(prefix = &quot;spring.datasource.one&quot;)</span><br>    DataSource <span class="hljs-title function_">dsOne</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HikariDataSource</span>();<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-meta">@ConfigurationProperties(prefix = &quot;spring.datasource.two&quot;)</span><br>    DataSource <span class="hljs-title function_">dsTwo</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HikariDataSource</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.jdbctemplatemulti.config;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JdbcTemplateConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    JdbcTemplate <span class="hljs-title function_">jdbcTemplateOne</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;dsOne&quot;)</span> DataSource ds)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JdbcTemplate</span>(ds);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    JdbcTemplate <span class="hljs-title function_">jdbcTemplateTwo</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;dsTwo&quot;)</span> DataSource ds)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JdbcTemplate</span>(ds);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Spirngboot-MyBatis"><a href="#Spirngboot-MyBatis" class="headerlink" title="Spirngboot+MyBatis"></a>Spirngboot+MyBatis</h1><p>先配置properties，然后在Application前添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@MapperScan(basePackages = &quot;com.xgfm.mybatis.mapper&quot;)</span><br><br></code></pre></td></tr></table></figure>

<p>进行包扫描，找出全部的mapper文件</p>
<p>例子：</p>
<p>UserMapper和他的测试类们</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> com.xgfm.mybatis.model.User;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.*;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">//@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> &#123;<br>    <span class="hljs-meta">@Select(&quot;select * from user where id = #&#123;id&#125;&quot;)</span><br>    User <span class="hljs-title function_">userGetById</span><span class="hljs-params">(Long id)</span>;<br><br>    <span class="hljs-comment">//column为原来的，但这样很麻烦,这是解决model与数据库中的属性名称冲突的results</span><br>    <span class="hljs-meta">@Results(&#123;@Result(property = &quot;address&quot;,column = &quot;address&quot;)&#125;)</span><br>    <span class="hljs-meta">@Select(&quot;select * from user&quot;)</span><br>    List&lt;User&gt; <span class="hljs-title function_">getAllUsers</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-meta">@Insert(&quot;insert into user (username,address) values(#&#123;username&#125;,#&#123;address&#125;)&quot;)</span><br>    <span class="hljs-meta">@SelectKey(statement = &quot;select last_insert_id()&quot;,keyProperty = &quot;id&quot;,before = false,resultType = Long.class)</span><br>    Integer <span class="hljs-title function_">addUser</span><span class="hljs-params">(User user)</span>;<br><br>    <span class="hljs-meta">@Delete(&quot;delete from user where id = #&#123;id&#125;&quot;)</span><br>    Integer <span class="hljs-title function_">deleteById</span><span class="hljs-params">(Long id)</span>;<br><br>    <span class="hljs-meta">@Update(&quot;update user set username = #&#123;username&#125; where id = #&#123;id&#125;&quot;)</span><br>    Integer <span class="hljs-title function_">updateById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;username&quot;)</span> String username,<span class="hljs-meta">@Param(&quot;id&quot;)</span> Long id)</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>这里把@Mapper注释掉是因为在application中配置了包扫描。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>   UserMapper userMapper;<br>   <span class="hljs-meta">@Test</span><br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoads</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userMapper.userGetById(<span class="hljs-number">5L</span>);<br>       System.out.println(user);<br>   &#125;<br><br>   <span class="hljs-meta">@Test</span><br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">test02</span><span class="hljs-params">()</span> &#123;<br>       User user=<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>       user.setUsername(<span class="hljs-string">&quot;siyuan&quot;</span>);<br>       user.setAddress(<span class="hljs-string">&quot;cenima&quot;</span>);<br>       userMapper.addUser(user);<br>       <span class="hljs-type">Long</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> user.getId();<br>       System.out.println(id);<br>   &#125;<br></code></pre></td></tr></table></figure>

<p>测试类</p>
<h1 id="Spirngboot-MyBatis（XML）"><a href="#Spirngboot-MyBatis（XML）" class="headerlink" title="Spirngboot+MyBatis（XML）"></a>Spirngboot+MyBatis（XML）</h1><p>mapper</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br>        <span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span></span><br><span class="hljs-meta">                <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">                <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.xgfm.mybatis.mapper.UserMapper2&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;UserMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.xgfm.mybatis.model.User&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;username&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;address&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userGetById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;UserMap&quot;</span>&gt;</span><br>    select * from user where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getAllUsers&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;UserMap&quot;</span>&gt;</span><br>        select * from user<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addUser&quot;</span>  <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;com.xgfm.mybatis.model.User&quot;</span> <span class="hljs-attr">useGeneratedKeys</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><br>        insert into user (username,address) values (#&#123;username&#125;,#&#123;address&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteById&quot;</span>&gt;</span><br>        delete from user where id =#&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateById&quot;</span>&gt;</span><br>        update user set username=#&#123;username&#125; where id =#&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>mapper接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.mybatis.mapper;<br><br><span class="hljs-keyword">import</span> com.xgfm.mybatis.model.User;<br><span class="hljs-keyword">import</span> org.apache.ibatis.annotations.*;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">//@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper2</span> &#123;<br>    User <span class="hljs-title function_">userGetById</span><span class="hljs-params">(Long id)</span>;<br>    List&lt;User&gt; <span class="hljs-title function_">getAllUsers</span><span class="hljs-params">()</span>;<br>    Integer <span class="hljs-title function_">addUser</span><span class="hljs-params">(User user)</span>;<br>    Integer <span class="hljs-title function_">deleteById</span><span class="hljs-params">(Long id)</span>;<br>    Integer <span class="hljs-title function_">updateById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;username&quot;)</span> String username, <span class="hljs-meta">@Param(&quot;id&quot;)</span> Long id)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以将xml映射文件放置到java的mapper中去，此时就需要在pom.xml文件之中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>如果想把xml直接放置在resources的mapper下，可以在properties中配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">mybatis.mapper-locations</span>=<span class="hljs-string">classpath:mappers/*.xml</span><br></code></pre></td></tr></table></figure>

<h1 id="Mybatis多数据源"><a href="#Mybatis多数据源" class="headerlink" title="Mybatis多数据源"></a>Mybatis多数据源</h1><p>首先配置config</p>
<ol>
<li><p>与jdbcTemplate相同的DataSourceConfig</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-meta">@ConfigurationProperties(prefix = &quot;spring.datasource.one&quot;)</span><br>    DataSource <span class="hljs-title function_">dsOne</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HikariDataSource</span>();<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-meta">@ConfigurationProperties(prefix = &quot;spring.datasource.two&quot;)</span><br>    DataSource <span class="hljs-title function_">dsTwo</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HikariDataSource</span>();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>完成DataSource的创建</p>
</li>
<li><p>配置MybatisConfigOne和MybatisConfigTwo</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.mybatismulti.config;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;<br><span class="hljs-keyword">import</span> org.mybatis.spring.SqlSessionFactoryBean;<br><span class="hljs-keyword">import</span> org.mybatis.spring.SqlSessionTemplate;<br><span class="hljs-keyword">import</span> org.mybatis.spring.annotation.MapperScan;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@MapperScan(basePackages = &quot;com.xgfm.mybatismulti.mapper1&quot;,sqlSessionFactoryRef =&quot;sqlSessionFactory1&quot;,sqlSessionTemplateRef = &quot;sqlSessionTemplate1&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisConfigOne</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-meta">@Qualifier(&quot;dsOne&quot;)</span><br>    DataSource ds;<br><br>    <span class="hljs-meta">@Bean</span><br>    SqlSessionFactory <span class="hljs-title function_">sqlSessionFactory1</span><span class="hljs-params">()</span>&#123;<br>        SqlSessionFactory sqlSessionFactory=<span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">SqlSessionFactoryBean</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBean</span>();<br>            bean.setDataSource(ds);<br>            sqlSessionFactory = bean.getObject();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> sqlSessionFactory;<br>    &#125;<br>    <span class="hljs-meta">@Bean</span><br>    SqlSessionTemplate <span class="hljs-title function_">sqlSessionTemplate1</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionTemplate</span>(sqlSessionFactory1());<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>需要注意的是添加包扫描注释</p>
</li>
<li><p>创建mapper1和mapper2分别存储不同的mapper文件,与mybatisxml类似，这里就不记录了，但还是需要在resoures同目录配置，否则会找不到（因为我比较喜欢在resources下放xml）</p>
</li>
<li><p>与mybatis一样写映射文件即可</p>
</li>
</ol>
<h1 id="Mybatis主从复制、JPA"><a href="#Mybatis主从复制、JPA" class="headerlink" title="Mybatis主从复制、JPA"></a>Mybatis主从复制、JPA</h1><p>docker搭建2个mysql，然后修改mysqld.cnf改不明白，先跳过了</p>
<h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisApplicationTests</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    RedisTemplate redisTemplate;<br><br>    <span class="hljs-meta">@Autowired</span><br>    StringRedisTemplate stringRedisTemplate;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoads</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setUsername(<span class="hljs-string">&quot;xgfm&quot;</span>);<br>        user.setAddress(<span class="hljs-string">&quot;xgfmccc&quot;</span>);<br>        <span class="hljs-type">ValueOperations</span> <span class="hljs-variable">ops</span> <span class="hljs-operator">=</span> redisTemplate.opsForValue();<br>        ops.set(<span class="hljs-string">&quot;u&quot;</span>,user);<br>        <span class="hljs-type">User</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> (User) ops.get(<span class="hljs-string">&quot;u&quot;</span>);<br>        System.out.println(u);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span>&#123;<br>        ValueOperations&lt;String, String&gt; ops = stringRedisTemplate.opsForValue();<br>        ops.set(<span class="hljs-string">&quot;xgfm&quot;</span>,<span class="hljs-string">&quot;xgfmccc&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">xgfm</span> <span class="hljs-operator">=</span> ops.get(<span class="hljs-string">&quot;xgfm&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;xgfm = &quot;</span> + xgfm);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<p>给一些kongzhitai代码</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-comment">--进入redis容器</span><br>docker exec -<span class="hljs-keyword">it</span> redis redis-cli<br><span class="hljs-comment">--展示所有key</span><br><span class="hljs-built_in">keys</span> *<br><span class="hljs-comment">--验证密码</span><br>auth <span class="hljs-number">123</span><br></code></pre></td></tr></table></figure>

<h1 id="Session共享"><a href="#Session共享" class="headerlink" title="Session共享"></a>Session共享</h1><p>将tomcat的session存入redis之中，三个tomcat就可以共用一个session</p>
<p>引入session，web，redis依赖</p>
<p>在8080和8081端口都开启服务，发现8081可以获取到8080的session中的数据，这是因为spring session使用代理过滤器，将所有的session操作拦截，自动同步至redis之中，也同时自动的从redis之中读取数据。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javax.servlet.http.HttpSession;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloController</span> &#123;<br>    <span class="hljs-meta">@Value(&quot;$&#123;server.port&#125;&quot;)</span><br>    Integer port;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/set&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">set</span><span class="hljs-params">(HttpSession session)</span>&#123;<br>        session.setAttribute(<span class="hljs-string">&quot;xgfm&quot;</span>,<span class="hljs-string">&quot;xgfmccc&quot;</span>);<br>        <span class="hljs-keyword">return</span> String.valueOf(port);<br>    &#125;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/get&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">get</span><span class="hljs-params">(HttpSession session)</span>&#123;<br>        String xgfm= (String) session.getAttribute(<span class="hljs-string">&quot;xgfm&quot;</span>);<br>        <span class="hljs-keyword">return</span> xgfm+<span class="hljs-string">&quot;:&quot;</span>+port;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>最主要的是要引入spring session的依赖才能实现该功能。</p>
<h1 id="redis处理接口幂等性"><a href="#redis处理接口幂等性" class="headerlink" title="redis处理接口幂等性"></a>redis处理接口幂等性</h1><p><img src="/2023/06/28/Springboot/image-20230718011455571.png" srcset="/img/loading.gif" lazyload alt="image-20230718011455571"></p>
<p>要编写的东西有这些</p>
<p>机制就是自定义注释</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> AutoIdempotent &#123;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后创建拦截器，在拦截器之中检查有没有带上token，如果没有则通过自定义异常来抛出token相关问题。如果有token或者该方法没有使用自定义的注释（即该方法不需要幂等性，不需要检查有无token）则返回true，进行下一步。</p>
<p>再放一下拦截器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdempotentInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    TokenService tokenService;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">if</span> (!(handler <span class="hljs-keyword">instanceof</span> HandlerMethod))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> ((HandlerMethod) handler).getMethod();<br>        <span class="hljs-type">AutoIdempotent</span> <span class="hljs-variable">annotation</span> <span class="hljs-operator">=</span> method.getAnnotation(AutoIdempotent.class);<br>        <span class="hljs-keyword">if</span> (annotation!=<span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">return</span> tokenService.checkToken(request);<br>            &#125; <span class="hljs-keyword">catch</span> (IdempotentException e) &#123;<br>                <span class="hljs-keyword">throw</span> e;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>其中的token则是用UUID生成，用tokenService和RedisService进行检查。</p>
<p>再放一下俩个service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.idempontent.token;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.core.StringRedisTemplate;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.core.ValueOperations;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisService</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    StringRedisTemplate stringRedisTemplate;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">setEx</span><span class="hljs-params">(String key,String value,Long expireTime)</span>&#123;<br>        <span class="hljs-type">boolean</span> result=<span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            ValueOperations&lt;String,String&gt;ops=stringRedisTemplate.opsForValue();<br>            ops.set(key,value);<br>            stringRedisTemplate.expire(key,expireTime, TimeUnit.SECONDS);<br>            result=<span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">exists</span><span class="hljs-params">(String key)</span>&#123;<br>        <span class="hljs-keyword">return</span> stringRedisTemplate.hasKey(key);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(String key)</span>&#123;<br>        <span class="hljs-keyword">if</span> (exists(key))&#123;<br>            <span class="hljs-keyword">return</span> stringRedisTemplate.delete(key);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.idempontent.token;<br><br>        <span class="hljs-keyword">import</span> com.xgfm.idempontent.exception.IdempotentException;<br>        <span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br>        <span class="hljs-keyword">import</span> org.springframework.http.HttpHeaders;<br>        <span class="hljs-keyword">import</span> org.springframework.http.HttpRequest;<br>        <span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br>        <span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><br>        <span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br>        <span class="hljs-keyword">import</span> java.util.UUID;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenService</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    RedisService redisService;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">createToken</span><span class="hljs-params">()</span>&#123;<br>        String uuid= UUID.randomUUID().toString();<br>        redisService.setEx(uuid,uuid,<span class="hljs-number">10000L</span>);<br>        <span class="hljs-keyword">return</span> uuid;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">checkToken</span><span class="hljs-params">(HttpServletRequest request)</span> <span class="hljs-keyword">throws</span> IdempotentException &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">&quot;token&quot;</span>);<br>        <span class="hljs-keyword">if</span> (StringUtils.isEmpty(token))&#123;<br>            token = request.getParameter(<span class="hljs-string">&quot;token&quot;</span>);<br>            <span class="hljs-keyword">if</span> (StringUtils.isEmpty(token))&#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdempotentException</span>(<span class="hljs-string">&quot;token 不存在&quot;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!redisService.exists(token))&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdempotentException</span>(<span class="hljs-string">&quot;重复操作！&quot;</span>);<br>        &#125;<br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">remove</span> <span class="hljs-operator">=</span> redisService.remove(token);<br>        <span class="hljs-keyword">if</span> (!remove)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdempotentException</span>(<span class="hljs-string">&quot;重复操作！&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h1 id="RESTful简介"><a href="#RESTful简介" class="headerlink" title="RESTful简介"></a>RESTful简介</h1><p>REST是一种Web软件架构风格，是一种风格，并不是标准。匹配或兼容这种架构风格的网络服务称为REST服务。在SpringBoot中构建RESTful非常容易，因为其提供了自动化配置方案。</p>
<h1 id="快速构建RESTful应用"><a href="#快速构建RESTful应用" class="headerlink" title="快速构建RESTful应用"></a>快速构建RESTful应用</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Entity(name=&quot;user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-meta">@Id</span><br>    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>创建model并且添加如上注释</p>
<p>再添加一个空的dao层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.restful.dao;<br><br><span class="hljs-keyword">import</span> com.xgfm.restful.model.User;<br><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserDao</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JpaRepository</span>&lt;User,Long&gt; &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后就可以直接通过访问路径进行相对的操作了，非常方便</p>
<h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><p>get</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span><span class="hljs-regexp">/users/</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h3 id="添加"><a href="#添加" class="headerlink" title="添加"></a>添加</h3><p>post&#x2F;json添加数据</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span>/users<br></code></pre></td></tr></table></figure>

<h3 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h3><p>put&#x2F;json</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span><span class="hljs-regexp">/users/</span><span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>

<h3 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://localhost:8080/users?page=0&amp;size=3&amp;<span class="hljs-built_in">sort</span>=<span class="hljs-built_in">id</span>,desc<br></code></pre></td></tr></table></figure>

<h1 id="RESTful定制操作"><a href="#RESTful定制操作" class="headerlink" title="RESTful定制操作"></a>RESTful定制操作</h1><h3 id="RestResource注解"><a href="#RestResource注解" class="headerlink" title="@RestResource注解"></a>@RestResource注解</h3><p>自定义一些数据库操作在userDao中定义声明方法，不用写对应的实现，但要满足对应的要求</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserDao</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JpaRepository</span>&lt;User,Long&gt; &#123;<br>    List&lt;User&gt; <span class="hljs-title function_">findUserByUsernameIs</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;username&quot;)</span>String username)</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>可以添加@RestResource来选择暴露的路径</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestResource(path = &quot;byname&quot;)</span><br>    List&lt;User&gt; <span class="hljs-title function_">findUserByUsernameIs</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;username&quot;)</span>String username)</span>;<br></code></pre></td></tr></table></figure>

<p>比如这样之后，访问查询路径就不再是…&#x2F;findUserByUsernameIs{?username}而是…&#x2F;byname{?username}了</p>
<p>这个注解还能够屏蔽原有的方法</p>
<p>比如我想要屏蔽deleteById，只需要重写该方法并且注释给定exported值为false</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br>    <span class="hljs-meta">@RestResource(exported = false)</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteById</span><span class="hljs-params">(Long along)</span>;<br></code></pre></td></tr></table></figure>

<h3 id="RepositoryRestResource注解"><a href="#RepositoryRestResource注解" class="headerlink" title="@RepositoryRestResource注解"></a>@RepositoryRestResource注解</h3><p>path,默认类名为users，例如修改为people，那么路径中的users要改为users</p>
<p>collectionResourceRel指的是下图users处</p>
<p>itemResourceRel指的是下图蓝色处</p>
<p><img src="/2023/06/28/Springboot/image-20230718011509108.png" srcset="/img/loading.gif" lazyload alt="image-20230718011509108"></p>
<h1 id="Spring-Cache"><a href="#Spring-Cache" class="headerlink" title="Spring Cache"></a>Spring Cache</h1><p>传统SSM中就可以使用</p>
<p>是缓存体系的抽象实现</p>
<ul>
<li>@EnableCaching</li>
<li>@Cacheable</li>
<li>@CachePut</li>
<li>@CacheEvict</li>
<li>@Caching</li>
<li>@CacheConfig</li>
</ul>
<p>配置redis的properties</p>
<h3 id="EnableCaching"><a href="#EnableCaching" class="headerlink" title="@EnableCaching"></a>@EnableCaching</h3><p>在application中添加该注解，开启缓存功能</p>
<p>参数使用的基本都是默认即可</p>
<h3 id="Cacheable"><a href="#Cacheable" class="headerlink" title="@Cacheable"></a>@Cacheable</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Cacheable(cacheNames = &quot;star&quot;)</span><br></code></pre></td></tr></table></figure>

<p>对应方法开启缓存，需要添加cacheNames（前缀）否则会报错,默认情况下该参数也会作为缓存的key</p>
<h3 id="CacheConfig"><a href="#CacheConfig" class="headerlink" title="@CacheConfig"></a>@CacheConfig</h3><p>这个注解在类上使用，用来描述该类中所有方法使用的缓存key，也可以不使用该注解，直接在方法前使用@Cacheable</p>
<h1 id="Spring-Cache自定义缓存key"><a href="#Spring-Cache自定义缓存key" class="headerlink" title="Spring Cache自定义缓存key"></a>Spring Cache自定义缓存key</h1><p>如果方法存在多个参数，则默认情况下多个参数共同作为缓存的key。</p>
<p>也可以自己指定：在@Cacheable中的key的参数设置为#参数名</p>
<p>也可以使用SPEL表达式</p>
<p>同时也可以完全进行自定义key</p>
<p>创建MyKeyGenerator自定义类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyKeyGenerator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">KeyGenerator</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">generate</span><span class="hljs-params">(Object target, Method method, Object... params)</span> &#123;<br>        String s=target.toString()+<span class="hljs-string">&quot;:&quot;</span>+method.getName()+<span class="hljs-string">&quot;:&quot;</span>+ Arrays.toString(params);<br>        <span class="hljs-keyword">return</span> s;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在service中进行使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    MyKeyGenerator myKeyGenerator;<br><br>    <span class="hljs-meta">@Cacheable(cacheNames = &quot;star&quot; ,keyGenerator = &quot;myKeyGenerator&quot;)</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUserById</span><span class="hljs-params">(Long id)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;getById&quot;</span>+id);<br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span><span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setId(id);<br>        user.setUsername(<span class="hljs-string">&quot;xgfm&quot;</span>);<br>        <span class="hljs-keyword">return</span> user;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h1 id="更新缓存"><a href="#更新缓存" class="headerlink" title="更新缓存"></a>更新缓存</h1><p>在service中添加方法，如果缓存不存在则进行缓存，存在则进行更新</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@CachePut(cacheNames = &quot;c1&quot;,key=&quot;#user.id&quot;)</span><br><span class="hljs-keyword">public</span> User <span class="hljs-title function_">updateUserById</span><span class="hljs-params">(User user)</span>&#123;<br>    <span class="hljs-keyword">return</span> user;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="清空缓存"><a href="#清空缓存" class="headerlink" title="清空缓存"></a>清空缓存</h1><p>在service中添加方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs JAVA"><span class="hljs-meta">@CacheEvict(cacheNames = &quot;c1&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUserById</span><span class="hljs-params">(Long id)</span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;deleteByUserId&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Spring-Security"><a href="#Spring-Security" class="headerlink" title="Spring Security"></a>Spring Security</h1><p>安全管理！</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>添加该依赖后，项目中的所有接口都被保护起来了</p>
<p>输入接口后会自动跳转至login</p>
<p>账号：admin   密码：在控制台会出现一次性密码</p>
<p>Using generated security password: ab460a73-3b0b-4198-bf8c-1ef300062254</p>
<h1 id="HttpSecurity配置"><a href="#HttpSecurity配置" class="headerlink" title="HttpSecurity配置"></a>HttpSecurity配置</h1><p>目前的直接配置是对所有的接口进行拦截，实际上肯定是行不通的，是需要配置类似白名单的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        http.authorizeRequests()<br>                .antMatchers(<span class="hljs-string">&quot;/admin/**&quot;</span>).hasRole(<span class="hljs-string">&quot;admin&quot;</span>)<br>                .antMatchers(<span class="hljs-string">&quot;user/**&quot;</span>).hasAnyRole(<span class="hljs-string">&quot;admin&quot;</span>,<span class="hljs-string">&quot;user&quot;</span>)<br>                .anyRequest().authenticated()<br>                .and()<br>                .formLogin()<br>                .loginProcessingUrl(<span class="hljs-string">&quot;/doLogin&quot;</span>)<br>                .permitAll()<br>                .and()<br>                .csrf().disable();<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>如此配置完成之后，admin可以访问admin和user的网页，而user只能访问user的网页。</p>
<p>先放一下，这套springSecurtiy好像有点老旧</p>
<h1 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h1><p>使用HTTP端口进行连接可以避免被拦截</p>
<p>websocket支持跨域连接</p>
<h1 id="Spring-boot-WebSocket-聊天室"><a href="#Spring-boot-WebSocket-聊天室" class="headerlink" title="Spring boot +WebSocket 聊天室"></a>Spring boot +WebSocket 聊天室</h1><p>选择web和websocket依赖。</p>
<p>如果是单聊需要存在用户的概念，需要登录</p>
<p>而点对面就不需要登录了。</p>
<p>这里使用webJar，依赖如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.webjars<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>stomp-websocket<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>再加上jquery的依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.webjars<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jquery<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>以及添加locator core的依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.webjars<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>webjars-locator-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.46<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>还有这个依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.webjars<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>sockjs-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>编写WebSocketConfig继承WebSocketMessageBrokerConfigurer接口重写registerStompEndpoints和configureMessageBroker方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.chat01.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.messaging.simp.config.MessageBrokerRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.socket.config.annotation.EnableWebSocketMessageBroker;<br><span class="hljs-keyword">import</span> org.springframework.web.socket.config.annotation.StompEndpointRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurer;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableWebSocketMessageBroker</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebSocketMessageBrokerConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerStompEndpoints</span><span class="hljs-params">(StompEndpointRegistry registry)</span> &#123;<br>        registry.addEndpoint(<span class="hljs-string">&quot;/chat&quot;</span>).withSockJS();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configureMessageBroker</span><span class="hljs-params">(MessageBrokerRegistry registry)</span> &#123;<br>        registry.enableSimpleBroker(<span class="hljs-string">&quot;/topic&quot;</span>);<br><span class="hljs-comment">//        registry.setApplicationDestinationPrefixes(&quot;/app&quot;);</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>编写controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.chat01.controller;<br><br><span class="hljs-keyword">import</span> com.xgfm.chat01.model.Message;<br><span class="hljs-keyword">import</span> org.springframework.messaging.handler.annotation.MessageMapping;<br><span class="hljs-keyword">import</span> org.springframework.messaging.handler.annotation.SendTo;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GreetingController</span> &#123;<br><br>    <span class="hljs-meta">@MessageMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-meta">@SendTo(&quot;/topic/greetings&quot;)</span><br>    <span class="hljs-keyword">public</span> Message <span class="hljs-title function_">greeting</span><span class="hljs-params">(Message message)</span>&#123;<br>        <span class="hljs-keyword">return</span> message;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>然后编写message的model，属性为username和content，分别为发送人和发送信息内容</p>
<p>在resources中的static中编写模型</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/webjars/jquery/jquery.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/webjars/sockjs-client/sockjs.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/webjars/stomp-websocket/stomp.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span>请输入用户名：<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;用户名&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;连接&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;connect&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;断开连接&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;disconnect&quot;</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">&quot;disabled&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;chat&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>请输入聊天内容<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;content&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;聊天内容&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span> =<span class="hljs-string">&quot;send&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;发送&quot;</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">&quot;disabled&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> stompClient;</span><br><span class="language-javascript">    $(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        $(<span class="hljs-string">&quot;#connect&quot;</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">connect</span>();</span><br><span class="language-javascript">            $(<span class="hljs-string">&quot;#send&quot;</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                stompClient.<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;/hello&quot;</span>,&#123;&#125;,<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<span class="hljs-string">&quot;name&quot;</span>:$(<span class="hljs-string">&quot;#username&quot;</span>).<span class="hljs-title function_">val</span>(),<span class="hljs-string">&quot;content&quot;</span>:$(<span class="hljs-string">&quot;#content&quot;</span>).<span class="hljs-title function_">val</span>()&#125;))</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">            $(<span class="hljs-string">&quot;#disconnect&quot;</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                stompClient.<span class="hljs-title function_">disconnect</span>();</span><br><span class="language-javascript">                <span class="hljs-title function_">setConnect</span>(<span class="hljs-literal">false</span>);</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">connect</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">if</span> (!$(<span class="hljs-string">&quot;#username&quot;</span>).<span class="hljs-title function_">val</span>())&#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> socketjs=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SockJS</span>(<span class="hljs-string">&quot;/chat&quot;</span>);</span><br><span class="language-javascript">        stompClient=<span class="hljs-title class_">Stomp</span>.<span class="hljs-title function_">over</span>(socketjs);</span><br><span class="language-javascript">        stompClient.<span class="hljs-title function_">connect</span>(&#123;&#125;,<span class="hljs-keyword">function</span> (<span class="hljs-params">frame</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">setConnect</span>(<span class="hljs-literal">true</span>);</span><br><span class="language-javascript">            stompClient.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&quot;/topic/greetings&quot;</span>,<span class="hljs-keyword">function</span> (<span class="hljs-params">greeting</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> msgContent=<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(greeting.<span class="hljs-property">body</span>);</span><br><span class="language-javascript">                $(<span class="hljs-string">&quot;#chat&quot;</span>).<span class="hljs-title function_">append</span>(<span class="hljs-string">&quot;&lt;div&gt;&quot;</span>+msgContent.<span class="hljs-property">name</span>+<span class="hljs-string">&quot;:&quot;</span>+msgContent.<span class="hljs-property">content</span>+<span class="hljs-string">&quot;&lt;/div&gt;&quot;</span>);</span><br><span class="language-javascript">            &#125;);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">    </span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">setConnect</span>(<span class="hljs-params">connected</span>) &#123;</span><br><span class="language-javascript">        $(<span class="hljs-string">&quot;#connect&quot;</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">&quot;disabled&quot;</span>,connected);</span><br><span class="language-javascript">        $(<span class="hljs-string">&quot;#disconnect&quot;</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">&quot;disabled&quot;</span>,!connected);</span><br><span class="language-javascript">        $(<span class="hljs-string">&quot;#send&quot;</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">&quot;disabled&quot;</span>,!connected);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>完成。</p>
<h1 id="消息中间件"><a href="#消息中间件" class="headerlink" title="消息中间件"></a>消息中间件</h1><p>先咕咕咕一下，等会补上</p>
<h1 id="邮件发送基础知识"><a href="#邮件发送基础知识" class="headerlink" title="邮件发送基础知识"></a>邮件发送基础知识</h1><p>SMTP 协议全称为 Simple Mail Transfer Protocol，译作简单邮件传输协议，它定义了邮件客户端软件与 SMTP 服务器之间，以及 SMTP 服务器与 SMTP 服务器之间的通信规则。</p>
<p>而 POP3 协议全称为 Post Office Protocol ，译作邮局协议，它定义了邮件客户端与 POP3 服务器之间的通信规则</p>
<h2 id="发送QQ邮件准备工作"><a href="#发送QQ邮件准备工作" class="headerlink" title="发送QQ邮件准备工作"></a>发送QQ邮件准备工作</h2><p>首先需要打开邮箱–账户–SMTP服务开启，从而获取授权码</p>
<p><img src="/2023/06/28/Springboot/image-20230718011527463.png" srcset="/img/loading.gif" lazyload alt="image-20230718011527463"></p>
<h1 id="发送邮件"><a href="#发送邮件" class="headerlink" title="发送邮件"></a>发送邮件</h1><h3 id="发送简单邮件"><a href="#发送简单邮件" class="headerlink" title="发送简单邮件"></a>发送简单邮件</h3><p>在application.properties中配置相关信息</p>
<p>properties配置：（需要注意的是username是qq邮箱地址，而password不是密码，是授权码）</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs PROPERTIES"><span class="hljs-attr">spring.mail.host</span>=<span class="hljs-string">smtp.qq.com</span><br><span class="hljs-attr">spring.mail.port</span>=<span class="hljs-string">465</span><br><span class="hljs-attr">spring.mail.username</span>=<span class="hljs-string">获取到授权码的QQ邮箱</span><br><span class="hljs-attr">spring.mail.password</span>=<span class="hljs-string">授权码</span><br><span class="hljs-attr">spring.mail.default-encoding</span>=<span class="hljs-string">utf-8</span><br><span class="hljs-attr">spring.mail.properties.mail.smtp.socketFactory.class</span>=<span class="hljs-string">javax.net.ssl.SSLSocketFactory</span><br><span class="hljs-attr">spring.mail.properties.mail.debug</span>=<span class="hljs-string">true</span><br><br></code></pre></td></tr></table></figure>

<p>测试–方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>    JavaMailSender javaMailSender;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoads</span><span class="hljs-params">()</span> &#123;<br>        SimpleMailMessage simpMsg=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleMailMessage</span>();<br>        simpMsg.setFrom(<span class="hljs-string">&quot;发件人邮箱（properties中的邮箱）&quot;</span>);<br>        simpMsg.setTo(<span class="hljs-string">&quot;收件人的邮箱&quot;</span>);<br>        simpMsg.setSentDate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        simpMsg.setSubject(<span class="hljs-string">&quot;邮件主题-测试邮件&quot;</span>);<br>        simpMsg.setText(<span class="hljs-string">&quot;邮件内容-测试邮件&quot;</span>);<br>        javaMailSender.send(simpMsg);<br>    &#125;<br></code></pre></td></tr></table></figure>

<h3 id="发送带附件的邮件"><a href="#发送带附件的邮件" class="headerlink" title="发送带附件的邮件"></a>发送带附件的邮件</h3><p>需要配置复合邮件类（javaMailSender）使用IO流的file进行文件输入，从而完成附件的携带，其他代码是不变的，只需要修改一下test类即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> MessagingException &#123;<br>        <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;E:\\zp\\xg.jpg&quot;</span>);<br>        <span class="hljs-type">MimeMessage</span> <span class="hljs-variable">mimeMessage</span> <span class="hljs-operator">=</span> javaMailSender.createMimeMessage();<br>        <span class="hljs-type">MimeMessageHelper</span> <span class="hljs-variable">helper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MimeMessageHelper</span>(mimeMessage, <span class="hljs-literal">true</span>);<br>        helper.setFrom(<span class="hljs-string">&quot;发件人邮箱&quot;</span>);<br>        helper.setTo(<span class="hljs-string">&quot;收件人邮箱&quot;</span>);<br>        helper.setSentDate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        helper.setSubject(<span class="hljs-string">&quot;邮件主题-测试邮件&quot;</span>);<br>        helper.setText(<span class="hljs-string">&quot;邮件内容-测试邮件&quot;</span>);<br>        helper.addAttachment(file.getName(),file);<br>        javaMailSender.send(mimeMessage);<br>    &#125;<br></code></pre></td></tr></table></figure>

<h3 id="发送带图片资源的邮件"><a href="#发送带图片资源的邮件" class="headerlink" title="发送带图片资源的邮件"></a>发送带图片资源的邮件</h3><p>图片存在于邮件正文之中，而不是附件之中。</p>
<p>需要在setText配置参数true，从而支持html，然后使用html标签中的img标签src进行占位，通过addInLine和File来给占位的地方放置图片，但这种方式并不常用，如果有使用邮件的需求，使用thymeleaf和Freemarker模板会好用很多很多。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> MessagingException &#123;<br>        <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;E:\\zp\\xg.jpg&quot;</span>);<br>        <span class="hljs-type">MimeMessage</span> <span class="hljs-variable">mimeMessage</span> <span class="hljs-operator">=</span> javaMailSender.createMimeMessage();<br>        <span class="hljs-type">MimeMessageHelper</span> <span class="hljs-variable">helper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MimeMessageHelper</span>(mimeMessage, <span class="hljs-literal">true</span>);<br>        helper.setFrom(<span class="hljs-string">&quot;发件人邮箱&quot;</span>);<br>        helper.setTo(<span class="hljs-string">&quot;收件人邮箱&quot;</span>);<br>        helper.setSentDate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        helper.setSubject(<span class="hljs-string">&quot;邮件主题-测试邮件&quot;</span>);<br>        helper.setText(<span class="hljs-string">&quot;&lt;div&gt;哥们带图片资源，哥们叼得一&lt;/div&gt;&lt;div&gt;&lt;img src=&#x27;cid:p01&#x27; /&gt;&lt;/div&gt;&quot;</span>,<span class="hljs-literal">true</span>);<br>        helper.addInline(<span class="hljs-string">&quot;p01&quot;</span>,file);<br>        javaMailSender.send(mimeMessage);<br>    &#125;<br></code></pre></td></tr></table></figure>

<h3 id="Freemarker邮件模板"><a href="#Freemarker邮件模板" class="headerlink" title="Freemarker邮件模板"></a>Freemarker邮件模板</h3><h5 id="前提准备"><a href="#前提准备" class="headerlink" title="前提准备"></a>前提准备</h5><p>编写模板（mail.ftl）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>欢迎$&#123;username&#125;入职$&#123;company&#125;,您的入职信息如下：<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>姓名<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>$&#123;username&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>职位<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>$&#123;position&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>薪水<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>$&#123;salary&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: red ;font-size: x-large&quot;</span> &gt;</span>希望在未来的日子里携手奋进！<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>编写model（User类）</p>
<h5 id="test方法"><a href="#test方法" class="headerlink" title="test方法"></a>test方法</h5><p>如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test3</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> MessagingException, IOException, TemplateException &#123;<br><br>        <span class="hljs-type">MimeMessage</span> <span class="hljs-variable">mimeMessage</span> <span class="hljs-operator">=</span> javaMailSender.createMimeMessage();<br>        <span class="hljs-type">MimeMessageHelper</span> <span class="hljs-variable">helper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MimeMessageHelper</span>(mimeMessage, <span class="hljs-literal">true</span>);<br>        helper.setFrom(<span class="hljs-string">&quot;收件人&quot;</span>);<br>        helper.setTo(<span class="hljs-string">&quot;发件人&quot;</span>);<br>        helper.setSentDate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        helper.setSubject(<span class="hljs-string">&quot;邮件主题-测试邮件&quot;</span>);<br>        <span class="hljs-type">Configuration</span> <span class="hljs-variable">cfg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>(Configuration.VERSION_2_3_30);<br>        cfg.setClassLoaderForTemplateLoading(MailApplicationTests.class.getClassLoader(), <span class="hljs-string">&quot;mail&quot;</span>);<br>        <span class="hljs-type">Template</span> <span class="hljs-variable">template</span> <span class="hljs-operator">=</span> cfg.getTemplate(<span class="hljs-string">&quot;mail.ftl&quot;</span>);<br>        User user=<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setUsername(<span class="hljs-string">&quot;星光浮梦&quot;</span>);<br>        user.setCompany(<span class="hljs-string">&quot;地下魔盗团&quot;</span>);<br>        user.setPosition(<span class="hljs-string">&quot;保安队长&quot;</span>);<br>        user.setSalary(<span class="hljs-number">9999999.0</span>);<br>        <span class="hljs-type">StringWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringWriter</span>();<br>        template.process(user, out);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> out.toString();<br>        helper.setText(text,<span class="hljs-literal">true</span>);<br>        System.out.println(<span class="hljs-string">&quot;内容text为   =&quot;</span>+text);<br>        javaMailSender.send(mimeMessage);<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>写的过程中出现了一些小失误，把setClassLoaderForTemplateLoading写成了setClassForTemplateLoading，导致一致报错，但是把Class文件导入到setClassForTemplateLoading，也还是会报错，等会研究一下这俩方法。</p>
<p>修改完成后成功发送邮件了。</p>
<p>与thymeleaf不同的在于freemarker模板需要自己配置路径，所以.ftl文件放在哪都差距不大，而Thymeleaf需要放置在templates之中才行，否则需要在properties中配置。</p>
<h3 id="Thymeleaf邮件模板"><a href="#Thymeleaf邮件模板" class="headerlink" title="Thymeleaf邮件模板"></a>Thymeleaf邮件模板</h3><p>与freemarker最大区别在于需要注入TemplateEngine这个类。</p>
<p>他可以帮助我们省去很多繁琐的配置过程，美中不足的是他不能直接放入user类，需要自己一个个输入。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>    TemplateEngine templateEngine;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test4</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> MessagingException, IOException, TemplateException &#123;<br><br>        <span class="hljs-type">MimeMessage</span> <span class="hljs-variable">mimeMessage</span> <span class="hljs-operator">=</span> javaMailSender.createMimeMessage();<br>        <span class="hljs-type">MimeMessageHelper</span> <span class="hljs-variable">helper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MimeMessageHelper</span>(mimeMessage, <span class="hljs-literal">true</span>);<br>        helper.setFrom(<span class="hljs-string">&quot;1499923379@qq.com&quot;</span>);<br>        helper.setTo(<span class="hljs-string">&quot;1499923379@qq.com&quot;</span>);<br>        helper.setSentDate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        helper.setSubject(<span class="hljs-string">&quot;邮件主题-测试邮件&quot;</span>);<br>        User user=<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setUsername(<span class="hljs-string">&quot;星光浮梦&quot;</span>);<br>        user.setCompany(<span class="hljs-string">&quot;地下魔盗团&quot;</span>);<br>        user.setPosition(<span class="hljs-string">&quot;保安队长&quot;</span>);<br>        user.setSalary(<span class="hljs-number">9999999.0</span>);<br>        Context ctx=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Context</span>();<br>        ctx.setVariable(<span class="hljs-string">&quot;username&quot;</span>,user.getUsername());<br>        ctx.setVariable(<span class="hljs-string">&quot;position&quot;</span>,user.getPosition());<br>        ctx.setVariable(<span class="hljs-string">&quot;company&quot;</span>,user.getCompany());<br>        ctx.setVariable(<span class="hljs-string">&quot;salary&quot;</span>,user.getSalary());<br>        <span class="hljs-type">String</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> templateEngine.process(<span class="hljs-string">&quot;mail.html&quot;</span>, ctx);<br>        helper.setText(text,<span class="hljs-literal">true</span>);<br>        javaMailSender.send(mimeMessage);<br>    &#125;<br></code></pre></td></tr></table></figure>

<h1 id="注解配置定时任务"><a href="#注解配置定时任务" class="headerlink" title="注解配置定时任务"></a>注解配置定时任务</h1><h3 id="Schduled"><a href="#Schduled" class="headerlink" title="@Schduled"></a>@Schduled</h3><p>在Application中添加EnableScheduling注解来开启定时任务。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MySchedule</span> &#123;<br>    <span class="hljs-meta">@Scheduled(fixedDelay = 1000)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fixedDelay</span><span class="hljs-params">()</span>&#123;<br>	    System.out.println(<span class="hljs-string">&quot;fixedDelay:&quot;</span>+<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>scheduled设置为当前任务结束后一秒执行一次，然后该程序就会在控制台不断输出当前任务执行的sout</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Scheduled(fixedRate = 1000)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fixedRate</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;fixedRate:&quot;</span>+<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>fixedRate和fixedDelay的区别在于fixedRate是在任务开启xx时间后执行，而fixedDelay则是在任务执行完xx时间后执行。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Scheduled(initialDelay = 1000,fixedRate = 1000)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initDelay</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;initDelay:&quot;</span>+<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>而initialDelay则是延迟xx时间后执行。</p>
<p>但延迟定时任务并不能很好的满足全部需求</p>
<p>这时就需要使用cron，cron表达式格式如下；</p>
<p>秒 分 小时 日 月 周 年</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Scheduled(cron = &quot;0/5 55 * * * *&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cron</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;cron:&quot;</span>+<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>该cron的意思为在任何年月日小时的55分钟，每5秒输出一次。</p>
<h3 id="Quartz注解"><a href="#Quartz注解" class="headerlink" title="@Quartz注解"></a>@Quartz注解</h3><p>一般在项目中，除非定时任务涉及到的业务实在过于简单才会使用@Scheduled注解来解决定时任务，否则大部分情况可能都是使用Quartz来做定时任务的。</p>
<p>创建项目时还需要添加I&#x2F;O下的Quartz Scheduler依赖。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyJob01</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;MyJob01 : &quot;</span>+<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyJob02</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">QuartzJobBean</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeInternal</span><span class="hljs-params">(JobExecutionContext context)</span> <span class="hljs-keyword">throws</span> JobExecutionException &#123;<br>        System.out.println(<span class="hljs-string">&quot;MyJob02 : &quot;</span>+name+<span class="hljs-string">&quot;  : &quot;</span>+<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>myjob01是作为组件注入容器，而Myjob02则是继承QuartzJobBean从而直接使用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QuartzConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    MethodInvokingJobDetailFactoryBean <span class="hljs-title function_">jobDetail01</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">MethodInvokingJobDetailFactoryBean</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MethodInvokingJobDetailFactoryBean</span>();<br>        bean.setTargetBeanName(<span class="hljs-string">&quot;myJob01&quot;</span>);<br>        bean.setTargetMethod(<span class="hljs-string">&quot;sayHello&quot;</span>);<br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    JobDetailFactoryBean <span class="hljs-title function_">jobDetail02</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">JobDetailFactoryBean</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span><span class="hljs-keyword">new</span> <span class="hljs-title class_">JobDetailFactoryBean</span>();<br>        bean.setJobClass(MyJob02.class);<br>        <span class="hljs-type">JobDataMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JobDataMap</span>();<br>        map.put(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;xgfm&quot;</span>);<br>        bean.setJobDataMap(map);<br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br>    <span class="hljs-meta">@Bean</span><br>    SimpleTriggerFactoryBean <span class="hljs-title function_">simpleTriggerFactoryBean</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">SimpleTriggerFactoryBean</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span><span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleTriggerFactoryBean</span>();<br>        bean.setJobDetail(jobDetail01().getObject());<br>        bean.setRepeatCount(<span class="hljs-number">3</span>);<br>        bean.setStartDelay(<span class="hljs-number">1000</span>);<br>        bean.setRepeatInterval(<span class="hljs-number">1000</span>);<br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    CronTriggerFactoryBean <span class="hljs-title function_">cronTriggerFactoryBean</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">CronTriggerFactoryBean</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CronTriggerFactoryBean</span>();<br>        bean.setJobDetail(jobDetail02().getObject());<br>        bean.setCronExpression(<span class="hljs-string">&quot;0/5 * * * * ?&quot;</span>);<br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    SchedulerFactoryBean <span class="hljs-title function_">schedulerFactoryBean</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">SchedulerFactoryBean</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span><span class="hljs-keyword">new</span> <span class="hljs-title class_">SchedulerFactoryBean</span>();<br>        bean.setTriggers(simpleTriggerFactoryBean().getObject(),cronTriggerFactoryBean().getObject());<br><br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>前俩个方法为JobDetailFactoryBean但是第一个查找bean时要注意是注入到容器中的bean，首字母需要小写（我就是因为没小写一直not found，不停报错）</p>
<p>然后俩个是定义触发器bean。</p>
<p>最后一个是将两个定义好的触发器加入到schedulerFactoryBean之中。</p>
<p>这些bean都需要添加@Bean注释。</p>
<h1 id="Swagger简介"><a href="#Swagger简介" class="headerlink" title="Swagger简介"></a>Swagger简介</h1><p>swagger的作用在于便于进行前后端分离。</p>
<p>它通过一个网站展示接口及其参数，便于前后端进行编写。</p>
<p>它本身就是一个开源项目。</p>
<p>注：<code>Swagger3.0</code>不兼容<code>SpringBoot2.6.x</code>及以上的版本，需要降低springboot的版本。</p>
<h1 id="Swagger2和Swagger3的区别"><a href="#Swagger2和Swagger3的区别" class="headerlink" title="Swagger2和Swagger3的区别"></a>Swagger2和Swagger3的区别</h1><h3 id="支持OpenAPI"><a href="#支持OpenAPI" class="headerlink" title="支持OpenAPI"></a>支持OpenAPI</h3><ul>
<li>接口和每个接口的操作</li>
<li>输入参数和响应内容</li>
<li>认证 方法</li>
<li>一些必要的联系信息，license等</li>
</ul>
<h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><p>在3.0版本中，只需要一个starter的maven坐标即可完成。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h3 id="接口地址"><a href="#接口地址" class="headerlink" title="接口地址"></a>接口地址</h3><p>文档接口地址和文档页面地址均发生变化。</p>
<p>文档接口地址：<a target="_blank" rel="noopener" href="http://localhost:8080/swagger-ui/index.html">http://localhost:8080/swagger-ui/index.html</a></p>
<p>该网页如下：</p>
<p><img src="/2023/06/28/Springboot/image-20230718025553616.png" srcset="/img/loading.gif" lazyload alt="image-20230718025553616"></p>
<h3 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h3><p>3.0提供了一些其他注解。不过2的注解在3中都是可以正常使用的。</p>
<h1 id="Swagger3–HelloWorld"><a href="#Swagger3–HelloWorld" class="headerlink" title="Swagger3–HelloWorld"></a>Swagger3–HelloWorld</h1><p>创建userController直接配置hello接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后启动服务，进入文档接口地址就直接会弹出所有的接口及其参数类型。</p>
<p>同时也可以编写SwaggerConfig进行对swagger文档页面进行自定义。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SwaggerConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    Docket <span class="hljs-title function_">docket</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Docket</span>(DocumentationType.OAS_30)<br>                .select()<br>                .apis(RequestHandlerSelectors.basePackage(<span class="hljs-string">&quot;com.xgfm.swagger3.controller&quot;</span>))<br>                .paths(PathSelectors.any())<br>                .build()<br>                .apiInfo(<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiInfoBuilder</span>()<br>                        .description(<span class="hljs-string">&quot;vhr 项目接口文档&quot;</span>)<br>                        .contact(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Contact</span>(<span class="hljs-string">&quot;xgfm&quot;</span>,<span class="hljs-string">&quot;http://xgfm737.github.io&quot;</span>,<span class="hljs-string">&quot;1111@qq.com&quot;</span>))<br>                        .version(<span class="hljs-string">&quot;v1.0&quot;</span>)<br>                        .title(<span class="hljs-string">&quot;API 测试文档&quot;</span>)<br>                        .license(<span class="hljs-string">&quot;Apache2.0&quot;</span>)<br>                        .licenseUrl(<span class="hljs-string">&quot;http://www.apache.org/licenses/LICENSE-2.0&quot;</span>)<br>                        .build()<br>                );<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Swagger注解"><a href="#Swagger注解" class="headerlink" title="Swagger注解"></a>Swagger注解</h1><h3 id="ApiOperation和-Operation"><a href="#ApiOperation和-Operation" class="headerlink" title="@ApiOperation和 @Operation"></a>@ApiOperation和 @Operation</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//    @ApiOperation(value = &quot;查询用户&quot;,notes = &quot;根据 id 查询用户&quot;)</span><br>    <span class="hljs-meta">@Operation(summary = &quot;查询用户&quot;,description =&quot;根据 id 查询用户&quot; )</span><br>    <span class="hljs-meta">@GetMapping(&quot;/users/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> String  <span class="hljs-title function_">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Integer id)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;user: &quot;</span>+id;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>二者在使用方法上类似，ApiOperation是swagger2的，而Operation则是3的，用法是基本一致的，第一个参数是方法的作用，第二个参数是注释。</p>
<h3 id="ApiImplicitParam"><a href="#ApiImplicitParam" class="headerlink" title="@ApiImplicitParam"></a>@ApiImplicitParam</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiImplicitParam(paramType = &quot;path&quot;,name = &quot;id&quot;,value = &quot;用户id&quot;,required = true)</span><br></code></pre></td></tr></table></figure>

<p>paramType参数可以填写：</p>
<ul>
<li>path：即放在地址栏之中</li>
<li>query：以key value方法传递</li>
<li>body：参数存在于请求体</li>
</ul>
<p>但是该行注释只是限制swagger文档接口的用法，并不会对实际上的操作产生其他影响。所以用处较小。</p>
<h3 id="ApiImplicitParams"><a href="#ApiImplicitParams" class="headerlink" title="@ApiImplicitParams"></a>@ApiImplicitParams</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiImplicitParams(&#123;</span><br><span class="hljs-meta">        @ApiImplicitParam(paramType = &quot;path&quot;,name = &quot;id&quot;,value = &quot;用户id&quot;,required = true),</span><br><span class="hljs-meta">        @ApiImplicitParam(paramType = &quot;path&quot;,name = &quot;uid&quot;,value = &quot;用户uid&quot;,required = false)</span><br><span class="hljs-meta">&#125;)</span><br></code></pre></td></tr></table></figure>

<p>作用是存放多个参数</p>
<h3 id="ApiResponses和-ApiResponse"><a href="#ApiResponses和-ApiResponse" class="headerlink" title="@ApiResponses和@ApiResponse"></a>@ApiResponses和@ApiResponse</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiResponses(&#123;</span><br><span class="hljs-meta">        @ApiResponse(responseCode = &quot;200&quot;,description = &quot;请求成功&quot;),</span><br><span class="hljs-meta">        @ApiResponse(responseCode = &quot;500&quot;,description = &quot;请求失败&quot;)</span><br><span class="hljs-meta">&#125;)</span><br></code></pre></td></tr></table></figure>

<p>格式如上，作用就是定义状态码定义的显示。</p>
<h3 id="ApiIgnore"><a href="#ApiIgnore" class="headerlink" title="@ApiIgnore"></a>@ApiIgnore</h3><p>如名字所示，直接忽略当前接口。</p>
<h3 id="ApiModelProperty和-ApiModel"><a href="#ApiModelProperty和-ApiModel" class="headerlink" title="@ApiModelProperty和@ApiModel"></a>@ApiModelProperty和@ApiModel</h3><p>这次把model也放出来，是因为需要添加ApiModel（类的解释）和ApiModelProperty（类中属性的解释）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiModel(value = &quot;用户实体类&quot;,description = &quot;这个类定义了用户的所有属性&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-meta">@ApiModelProperty(&quot;用户id&quot;)</span><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-meta">@ApiModelProperty(&quot;用户名&quot;)</span><br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-meta">@ApiModelProperty(&quot;用户地址&quot;)</span><br>    <span class="hljs-keyword">private</span> String address;<br><br>    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-built_in">this</span>.id = id;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> username;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUsername</span><span class="hljs-params">(String username)</span> &#123;<br>        <span class="hljs-built_in">this</span>.username = username;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getAddress</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> address;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAddress</span><span class="hljs-params">(String address)</span> &#123;<br>        <span class="hljs-built_in">this</span>.address = address;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;User&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&quot;</span> + id +<br>                <span class="hljs-string">&quot;, username=&#x27;&quot;</span> + username + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, address=&#x27;&quot;</span> + address + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>下面的这段是usercontroller中的方法，最主要是@RequestBody的使用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/user&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUser</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span>&#123;<br>        <span class="hljs-keyword">return</span> user.toString();<br>    &#125;<br></code></pre></td></tr></table></figure>



<p>然后该实体类就会有如下的注释：</p>
<p><img src="/2023/06/28/Springboot/image-20230718025607362.png" srcset="/img/loading.gif" lazyload alt="image-20230718025607362"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>仍然有一些小bug，但是松哥说是因为swagger3的原因，说不定使用swagger2会有更好的效果？</p>
<p>然后就是这个程序目前对于学生来说可能还是说用处不是很大。</p>
<p>最后附上全部的controller代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xgfm.swagger3.controller;<br><br><span class="hljs-keyword">import</span> com.xgfm.swagger3.model.User;<br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiImplicitParam;<br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiImplicitParams;<br><span class="hljs-keyword">import</span> io.swagger.annotations.ApiOperation;<br><span class="hljs-keyword">import</span> io.swagger.v3.oas.annotations.Operation;<br><span class="hljs-keyword">import</span> io.swagger.v3.oas.annotations.Parameter;<br><span class="hljs-keyword">import</span> io.swagger.v3.oas.annotations.parameters.RequestBody;<br><span class="hljs-keyword">import</span> io.swagger.v3.oas.annotations.responses.ApiResponse;<br><span class="hljs-keyword">import</span> io.swagger.v3.oas.annotations.responses.ApiResponses;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PathVariable;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><span class="hljs-keyword">import</span> springfox.documentation.annotations.ApiIgnore;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(&quot;/hello&quot;)</span><br>    <span class="hljs-meta">@ApiIgnore</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>    &#125;<br><br><span class="hljs-comment">//    @ApiOperation(value = &quot;查询用户&quot;,notes = &quot;根据 id 查询用户&quot;)</span><br>    <span class="hljs-meta">@ApiResponses(&#123;</span><br><span class="hljs-meta">            @ApiResponse(responseCode = &quot;200&quot;,description = &quot;请求成功&quot;),</span><br><span class="hljs-meta">            @ApiResponse(responseCode = &quot;500&quot;,description = &quot;请求失败&quot;)</span><br><span class="hljs-meta">    &#125;)</span><br>    <span class="hljs-meta">@Operation(summary = &quot;查询用户&quot;,description =&quot;根据 id 查询用户&quot; )</span><br>    <span class="hljs-meta">@ApiImplicitParam(paramType = &quot;path&quot;,name = &quot;id&quot;,value = &quot;用户id&quot;,required = true)</span><br><span class="hljs-comment">//    @ApiImplicitParams(&#123;</span><br><span class="hljs-comment">//            @ApiImplicitParam(paramType = &quot;path&quot;,name = &quot;id&quot;,value = &quot;用户id&quot;,required = true),</span><br><span class="hljs-comment">//            @ApiImplicitParam(paramType = &quot;path&quot;,name = &quot;uid&quot;,value = &quot;用户uid&quot;,required = false)</span><br><span class="hljs-comment">//    &#125;)</span><br>    <span class="hljs-meta">@GetMapping(&quot;/users/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> String  <span class="hljs-title function_">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Integer id)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;user: &quot;</span>+id;<br>    &#125;<br><br>    <span class="hljs-meta">@PostMapping(&quot;/user&quot;)</span><br><span class="hljs-comment">//    @ApiImplicitParam(paramType = &quot;body&quot;,name = &quot;user&quot;,value = &quot;用户对象&quot;,required = true)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUser</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span>&#123;<br>        <span class="hljs-keyword">return</span> user.toString();<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure>

<h1 id="数据校验"><a href="#数据校验" class="headerlink" title="数据校验"></a>数据校验</h1><ul>
<li>@Null 被注解的元素必须为 null</li>
<li>@NotNull 被注解的元素必须不为 null</li>
<li>@AssertTrue 被注解的元素必须为 true</li>
<li>@AssertFalse 被注解的元素必须为 false</li>
<li>@Min(value) 被注解的元素必须是一个数字，其值必须大于等于指定的最小值</li>
<li>@Max(value) 被注解的元素必须是一个数字，其值必须小于等于指定的最大值</li>
<li>@DecimalMin(value) 被注解的元素必须是一个数字，其值必须大于等于指定的最小值</li>
<li>@DecimalMax(value) 被注解的元素必须是一个数字，其值必须小于等于指定的最大值</li>
<li>@Size(max&#x3D;, min&#x3D;) 被注解的元素的大小必须在指定的范围内</li>
<li>@Digits (integer, fraction) 被注解的元素必须是一个数字，其值必须在可接受的范围内</li>
<li>@Past 被注解的元素必须是一个过去的日期</li>
<li>@Future 被注解的元素必须是一个将来的日期</li>
<li>@Pattern(regex&#x3D;,flag&#x3D;) 被注解的元素必须符合指定的正则表达式</li>
<li>@NotBlank(message &#x3D;) 验证字符串非 null，且长度必须大于0</li>
<li>@Email 被注解的元素必须是电子邮箱地址</li>
<li>@Length(min&#x3D;,max&#x3D;) 被注解的字符串的大小必须在指定的范围内</li>
<li>@NotEmpty 被注解的字符串的必须非空</li>
<li>@Range(min&#x3D;,max&#x3D;,message&#x3D;) 被注解的元素必须在合适的范围内</li>
</ul>
<h3 id="普通校验"><a href="#普通校验" class="headerlink" title="普通校验"></a>普通校验</h3><p>前端js校验和服务端校验</p>
<p>Springboot提供了自动化设置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> Long id;<br><span class="hljs-meta">@Size(min=5,max=8)</span><br><span class="hljs-keyword">private</span> String name;<br><span class="hljs-meta">@NotNull</span><br><span class="hljs-keyword">private</span> String address;<br><span class="hljs-meta">@DecimalMin(value=&quot;1&quot;)</span><br><span class="hljs-meta">@DecimalMax(value = &quot;200&quot;)</span><br><span class="hljs-keyword">private</span> Integer age;<br><span class="hljs-meta">@NotNull</span><br><span class="hljs-meta">@Email</span><br><span class="hljs-keyword">private</span> String email;<br></code></pre></td></tr></table></figure>

<p>user实体类添加注解。</p>
<p>并且在controller 类的方法同时也需要添加注释才可以开启校验。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/user&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addUser</span><span class="hljs-params">(<span class="hljs-meta">@Validated</span> User user)</span>&#123;<br>    &#125;<br></code></pre></td></tr></table></figure>

<h6 id="自定义检验错误"><a href="#自定义检验错误" class="headerlink" title="自定义检验错误"></a>自定义检验错误</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-meta">@Size(min=5,max=8,message = &quot;&#123;user.name.size&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-meta">@NotNull(message = &quot;&#123;user.address.notnull&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-meta">@DecimalMin(value=&quot;1&quot;,message = &quot;&#123;user.age.min&#125;&quot;)</span><br>    <span class="hljs-meta">@DecimalMax(value = &quot;200&quot;,message = &quot;&#123;user.age.max&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-meta">@NotNull(message = &quot;&#123;user.email.notnull&#125;&quot;)</span><br>    <span class="hljs-meta">@Email(message = &quot;&#123;user.email.pattern&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String email;<br></code></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">user.name.size</span>=<span class="hljs-string">name长度错了！</span><br><span class="hljs-attr">user.address.notnull</span>=<span class="hljs-string">address 不能为空哦</span><br><span class="hljs-attr">user.age.min</span>=<span class="hljs-string">age 最小为1</span><br><span class="hljs-attr">user.age.max</span>=<span class="hljs-string">age 最大为200</span><br><span class="hljs-attr">user.email.notnull</span>=<span class="hljs-string">email 不能为空哦</span><br><span class="hljs-attr">user.email.pattern</span>=<span class="hljs-string">email 格式错误</span><br></code></pre></td></tr></table></figure>

<p>首先需要创建ValidationMessage.properties。并在其中配置对应的数据检验错误，然后在model中添加message，也可以直接在model的message中写。</p>
<h3 id="分组校验"><a href="#分组校验" class="headerlink" title="分组校验"></a>分组校验</h3><p>普通校验是所有的属性进行重复校验效率较低。</p>
<p>而在业务逻辑中有些时候有些校验是不需要进行的。</p>
<p>首先创建两个接口。</p>
<p><img src="/2023/06/28/Springboot/image-20230718182633136.png" srcset="/img/loading.gif" lazyload alt="image-20230718182633136"></p>
<p>然后使得注解分入不同的groups</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-meta">@Size(min=5,max=8,message = &quot;&#123;user.name.size&#125;&quot;,groups = ValidationGroup1.class)</span><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-meta">@NotNull(message = &quot;&#123;user.address.notnull&#125;&quot;,groups = ValidationGroup2.class)</span><br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-meta">@DecimalMin(value=&quot;1&quot;,message = &quot;&#123;user.age.min&#125;&quot;,groups = &#123;ValidationGroup1.class,ValidationGroup2.class&#125;)</span><br>    <span class="hljs-meta">@DecimalMax(value = &quot;200&quot;,message = &quot;&#123;user.age.max&#125;&quot;,groups = &#123;ValidationGroup1.class,ValidationGroup2.class&#125;)</span><br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-meta">@NotNull(message = &quot;&#123;user.email.notnull&#125;&quot;)</span><br>    <span class="hljs-meta">@Email(message = &quot;&#123;user.email.pattern&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String email;<br></code></pre></td></tr></table></figure>

<p>然后在校验接口定义需要校验的组即可。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/user&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addUser</span><span class="hljs-params">(<span class="hljs-meta">@Validated(ValidationGroup1.class)</span> User user, BindingResult result)</span>&#123;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>如此一来就只会去校验属于group1的注释了，在本次例子中的校验group1就只有name和age。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%A1%86%E6%9E%B6/">#框架</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Springboot</div>
      <div>http://example.com/2023/06/28/Springboot/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>星光浮梦</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年6月28日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/06/29/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" title="机器学习">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">机器学习</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/06/22/docker/" title="docker">
                        <span class="hidden-mobile">docker</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"position":"left","width":300,"height":600},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
